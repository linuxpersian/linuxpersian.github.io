<!DOCTYPE html>
<html dir="rtl" lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ویویر مارک‌دان - ویکی لینوکس فارسی</title>
    <!-- استفاده از نسخه محلی Tailwind CSS به جای CDN -->
    <style>
        /* استایل‌های Tailwind CSS به صورت مستقیم */
        *, ::before, ::after {
            box-sizing: border-box;
            border-width: 0;
            border-style: solid;
            border-color: #e5e7eb;
        }
        
        ::before, ::after {
            --tw-content: '';
        }
        
        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            font-feature-settings: normal;
            font-variation-settings: normal;
        }
        
        body {
            margin: 0;
            line-height: inherit;
        }
        
        hr {
            height: 0;
            color: inherit;
            border-top-width: 1px;
        }
        
        abbr:where([title]) {
            -webkit-text-decoration: underline dotted;
            text-decoration: underline dotted;
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-size: inherit;
            font-weight: inherit;
        }
        
        a {
            color: inherit;
            text-decoration: inherit;
        }
        
        b, strong {
            font-weight: bolder;
        }
        
        code, kbd, samp, pre {
            font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
            font-size: 1em;
        }
        
        small {
            font-size: 80%;
        }
        
        sub, sup {
            font-size: 75%;
            line-height: 0;
            position: relative;
            vertical-align: baseline;
        }
        
        sub {
            bottom: -0.25em;
        }
        
        sup {
            top: -0.5em;
        }
        
        table {
            text-indent: 0;
            border-color: inherit;
            border-collapse: collapse;
        }
        
        button, input, optgroup, select, textarea {
            font-family: inherit;
            font-size: 100%;
            font-weight: inherit;
            line-height: inherit;
            color: inherit;
            margin: 0;
            padding: 0;
        }
        
        button, select {
            text-transform: none;
        }
        
        button, [type='button'], [type='reset'], [type='submit'] {
            -webkit-appearance: button;
            background-color: transparent;
            background-image: none;
        }
        
        :-moz-focusring {
            outline: auto;
        }
        
        :-moz-ui-invalid {
            box-shadow: none;
        }
        
        progress {
            vertical-align: baseline;
        }
        
        ::-webkit-inner-spin-button, ::-webkit-outer-spin-button {
            height: auto;
        }
        
        [type='search'] {
            -webkit-appearance: textfield;
            outline-offset: -2px;
        }
        
        ::-webkit-search-decoration {
            -webkit-appearance: none;
        }
        
        ::-webkit-file-upload-button {
            -webkit-appearance: button;
            font: inherit;
        }
        
        summary {
            display: list-item;
        }
        
        blockquote, dd, dl, figure, h1, h2, h3, h4, h5, h6, hr, p, pre {
            margin: 0;
        }
        
        fieldset {
            margin: 0;
            padding: 0;
        }
        
        legend {
            padding: 0;
        }
        
        menu, ol, ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        
        textarea {
            resize: vertical;
        }
        
        input::placeholder, textarea::placeholder {
            opacity: 1;
            color: #9ca3af;
        }
        
        button, [role="button"] {
            cursor: pointer;
        }
        
        :disabled {
            cursor: default;
        }
        
        img, svg, video, canvas, audio, iframe, embed, object {
            display: block;
            vertical-align: middle;
        }
        
        img, video {
            max-width: 100%;
            height: auto;
        }
        
        [hidden] {
            display: none;
        }
        
        /* استایل‌های کمکی */
        .flex {
            display: flex;
        }
        
        .flex-col {
            flex-direction: column;
        }
        
        .items-center {
            align-items: center;
        }
        
        .justify-center {
            justify-content: center;
        }
        
        .gap-4 {
            gap: 1rem;
        }
        
        .mb-4 {
            margin-bottom: 1rem;
        }
        
        .p-8 {
            padding: 2rem;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-gray-600 {
            color: #4b5563;
        }
        
        .text-red-500 {
            color: #ef4444;
        }
        
        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }
        
        .font-bold {
            font-weight: 700;
        }
        
        .mt-4 {
            margin-top: 1rem;
        }
        
        .px-4 {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        
        .bg-red-500 {
            background-color: #ef4444;
        }
        
        .text-white {
            color: #ffffff;
        }
        
        .rounded-lg {
            border-radius: 0.5rem;
        }
        
        .hover\:bg-red-600:hover {
            background-color: #dc2626;
        }
        
        .transition {
            transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }
        
        .mr-2 {
            margin-left: 0.5rem;
        }
        
        .bg-blue-500 {
            background-color: #3b82f6;
        }
        
        .hover\:bg-blue-600:hover {
            background-color: #2563eb;
        }
        
        .w-full {
            width: 100%;
        }
        
        .mb-2 {
            margin-bottom: 0.5rem;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.2/marked.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            /* رنگ‌های اصلی */
            --primary: #6750A4;
            --on-primary: #FFFFFF;
            --primary-container: #EADDFF;
            --on-primary-container: #21005D;
            
            /* رنگ‌های ثانویه */
            --secondary: #625B71;
            --on-secondary: #FFFFFF;
            --secondary-container: #E8DEF8;
            --on-secondary-container: #1D192B;
            
            /* رنگ‌های ترشیاری */
            --tertiary: #7D5260;
            --on-tertiary: #FFFFFF;
            --tertiary-container: #FFD8E4;
            --on-tertiary-container: #31111D;
            
            /* رنگ‌های خطا */
            --error: #B3261E;
            --on-error: #FFFFFF;
            --error-container: #F9DEDC;
            --on-error-container: #410E0B;
            
            /* رنگ‌های پس‌زمینه */
            --background: #FFFBFE;
            --on-background: #1C1B1F;
            --surface: #FFFBFE;
            --on-surface: #1C1B1F;
            --surface-variant: #E7E0EC;
            --on-surface-variant: #49454F;
            --outline: #79747E;
            --outline-variant: #CAC4D0;
            --shadow: #000000;
            --inverse-surface: #313033;
            --inverse-on-surface: #F4EFF4;
            --inverse-primary: #D0BCFF;
            --surface-tint: #6750A4;
            
            /* رنگ‌های موفقیت و هشدار */
            --success: #388E3C;
            --on-success: #FFFFFF;
            --warning: #F57C00;
            --on-warning: #FFFFFF;
            
            /* تم‌های رنگی جدید */
            --theme-blue: #1E88E5;
            --theme-green: #43A047;
            --theme-red: #E53935;
            --theme-orange: #FB8C00;
            --theme-purple: #8E24AA;
            --theme-teal: #00897B;
            --theme-amber: #FFB300;
            --theme-pink: #D81B60;
            --theme-indigo: #3949AB;
            
            /* بهبود نمایش کد */
            --code-bg: #282c34;
            --code-text: #abb2bf;
            --code-comment: #5c6370;
            --code-keyword: #c678dd;
            --code-string: #98c379;
            --code-number: #d19a66;
            --code-function: #61afef;
        }
        
        body.dark-mode {
            --primary: #D0BCFF;
            --on-primary: #381E72;
            --primary-container: #4F378B;
            --on-primary-container: #EADDFF;
            --secondary: #CCC2DC;
            --on-secondary: #332D41;
            --secondary-container: #4A4458;
            --on-secondary-container: #E8DEF8;
            --tertiary: #EFB8C8;
            --on-tertiary: #492532;
            --tertiary-container: #633B48;
            --on-tertiary-container: #FFD8E4;
            --error: #F2B8B5;
            --on-error: #601410;
            --error-container: #8C1D18;
            --on-error-container: #F9DEDC;
            --background: #1C1B1F;
            --on-background: #E6E1E6;
            --surface: #1C1B1F;
            --on-surface: #E6E1E6;
            --surface-variant: #49454F;
            --on-surface-variant: #CAC4D0;
            --outline: #938F99;
            --inverse-surface: #E6E1E6;
            --inverse-on-surface: #313033;
            --inverse-primary: #6750A4;
            --surface-tint: #D0BCFF;
            --success: #4CAF50;
            --on-success: #FFFFFF;
            --warning: #FF9800;
            --on-warning: #FFFFFF;
            
            /* بهبود نمایش کد در حالت تاریک */
            --code-bg: #1e1e1e;
            --code-text: #d4d4d4;
            --code-comment: #6a9955;
            --code-keyword: #569cd6;
            --code-string: #ce9178;
            --code-number: #b5cea8;
            --code-function: #dcdcaa;
        }
        
        /* تم‌های رنگی */
        body.theme-blue {
            --primary: var(--theme-blue);
            --primary-container: rgba(30, 136, 229, 0.1);
        }
        
        body.theme-green {
            --primary: var(--theme-green);
            --primary-container: rgba(67, 160, 71, 0.1);
        }
        
        body.theme-red {
            --primary: var(--theme-red);
            --primary-container: rgba(229, 57, 53, 0.1);
        }
        
        body.theme-orange {
            --primary: var(--theme-orange);
            --primary-container: rgba(251, 140, 0, 0.1);
        }
        
        body.theme-purple {
            --primary: var(--theme-purple);
            --primary-container: rgba(142, 36, 170, 0.1);
        }
        
        body.theme-teal {
            --primary: var(--theme-teal);
            --primary-container: rgba(0, 137, 123, 0.1);
        }
        
        body.theme-amber {
            --primary: var(--theme-amber);
            --primary-container: rgba(255, 179, 0, 0.1);
        }
        
        body.theme-pink {
            --primary: var(--theme-pink);
            --primary-container: rgba(216, 27, 96, 0.1);
        }
        
        body.theme-indigo {
            --primary: var(--theme-indigo);
            --primary-container: rgba(57, 73, 171, 0.1);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Vazirmatn', sans-serif;
            background: linear-gradient(135deg, var(--primary-container) 0%, var(--tertiary-container) 100%);
            color: var(--on-background);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }
        
        /* انیمیشن‌های کلی */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }
        
        @keyframes highlight {
            0% { background-color: rgba(255, 255, 0, 0.4); }
            100% { background-color: rgba(255, 255, 0, 0); }
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes glow {
            0% { box-shadow: 0 0 5px var(--primary); }
            50% { box-shadow: 0 0 20px var(--primary), 0 0 30px var(--primary); }
            100% { box-shadow: 0 0 5px var(--primary); }
        }
        
        /* نوار پیشرفت خواندن */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: var(--outline-variant);
            z-index: 1000;
        }
        
        .reading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--tertiary));
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* کانتینر اصلی */
        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 2rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            transition: all 0.3s ease;
            width: 90%;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease;
        }
        
        .dark-mode .container {
            background: rgba(28, 27, 31, 0.95);
        }
        
        /* هدر */
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--outline-variant);
            padding: 1rem 1.5rem;
            border-radius: 1.5rem 1.5rem 0 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideDown 0.5s ease;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: nowrap;
            gap: 0.5rem;
        }
        
        .header-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--on-surface);
            flex-grow: 1;
            text-align: center;
            background: linear-gradient(90deg, var(--primary), var(--tertiary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* نوار ابزار */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            margin: 1rem 0 1.5rem;
            flex-wrap: wrap;
            animation: slideDown 0.6s ease;
        }
        
        .toolbar-section {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        /* دکمه‌ها */
        .btn {
            background: var(--secondary-container);
            color: var(--on-secondary-container);
            border: none;
            border-radius: 1rem;
            padding: 0.6rem 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn:hover {
            background: var(--primary);
            color: var(--on-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
        }
        
        .btn-primary {
            background: var(--primary);
            color: var(--on-primary);
            box-shadow: 0 2px 8px rgba(103, 80, 164, 0.3);
        }
        
        .btn-primary:hover {
            box-shadow: 0 4px 12px rgba(103, 80, 164, 0.4);
        }
        
        .btn-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* جستجو */
        .search-container {
            position: relative;
            width: 100%;
            max-width: 500px;
        }
        
        .search-input {
            width: 100%;
            background: var(--surface-variant);
            color: var(--on-surface-variant);
            border: 2px solid var(--outline-variant);
            border-radius: 2rem;
            padding: 0.8rem 1rem 0.8rem 3rem;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(103, 80, 164, 0.1);
            outline: none;
        }
        
        .search-btn {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: var(--on-primary);
            border: none;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .search-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 2px 8px rgba(103, 80, 164, 0.4);
        }
        
        /* محتوای اصلی */
        .content-wrapper {
            display: flex;
            gap: 2rem;
            animation: fadeIn 0.7s ease;
        }
        
        .main-content {
            flex: 1;
            min-width: 0;
        }
        
        .sidebar {
            width: 300px;
            flex-shrink: 0;
            position: sticky;
            top: 120px;
            height: fit-content;
            max-height: calc(100vh - 140px);
            overflow-y: auto;
        }
        
        /* مارک‌دان */
        .markdown-content {
            background: var(--surface);
            border-radius: 1.5rem;
            padding: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            line-height: 1.8;
            direction: rtl;
            text-align: justify;
            position: relative;
            overflow: hidden;
        }
        
        .markdown-content::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, var(--primary), var(--tertiary));
            opacity: 0.1;
            border-radius: 0 0 0 100%;
        }
        
        .markdown-content h1 {
            color: var(--primary);
            font-size: 2.2rem;
            font-weight: 700;
            margin: 1.5rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--primary);
            position: relative;
        }
        
        .markdown-content h1::after {
            content: '';
            position: absolute;
            bottom: -3px;
            right: 0;
            width: 50px;
            height: 3px;
            background: var(--tertiary);
        }
        
        .markdown-content h2 {
            color: var(--on-surface);
            font-size: 2rem; /* افزایش اندازه */
            font-weight: 700; /* بولد کردن */
            margin: 1.8rem 0 1.2rem;
            padding-bottom: 0.6rem;
            border-bottom: 2px solid var(--outline-variant);
        }
        
        .markdown-content h3 {
            color: var(--on-surface);
            font-size: 1.7rem;
            font-weight: 600;
            margin: 1.5rem 0 0.8rem;
        }
        
        .markdown-content p {
            margin-bottom: 1rem;
            text-align: justify;
        }
        
        .markdown-content ul, .markdown-content ol {
            margin: 1rem 0;
            padding-right: 1.5rem;
        }
        
        .markdown-content li {
            margin-bottom: 0.5rem;
            position: relative;
        }
        
        .markdown-content li::before {
            content: '•';
            color: var(--primary);
            font-weight: bold;
            position: absolute;
            right: -1rem;
        }
        
        .markdown-content blockquote {
            border-right: 4px solid var(--primary);
            margin: 1.5rem 0;
            padding: 1rem 1.5rem;
            background: var(--primary-container);
            border-radius: 0 1rem 1rem 0;
            font-style: italic;
            position: relative;
        }
        
        .markdown-content blockquote::before {
            content: '"';
            font-size: 3rem;
            color: var(--primary);
            opacity: 0.3;
            position: absolute;
            top: -10px;
            right: 10px;
        }
        
        .markdown-content code {
            background: var(--surface-variant);
            padding: 0.2rem 0.5rem;
            border-radius: 0.3rem;
            font-family: monospace;
            font-size: 0.9em;
            color: var(--primary);
        }
        
        .markdown-content pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 1rem;
            overflow-x: auto;
            margin: 1.5rem 0;
            position: relative;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--outline-variant);
        }
        
        .markdown-content pre code {
            background: none;
            padding: 0;
            color: var(--code-text);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        /* بهبود نمایش کد */
        .markdown-content pre .token.comment,
        .markdown-content pre .token.prolog,
        .markdown-content pre .token.doctype,
        .markdown-content pre .token.cdata {
            color: var(--code-comment);
        }
        
        .markdown-content pre .token.punctuation {
            color: var(--code-text);
        }
        
        .markdown-content pre .token.property,
        .markdown-content pre .token.tag,
        .markdown-content pre .token.boolean,
        .markdown-content pre .token.number,
        .markdown-content pre .token.constant,
        .markdown-content pre .token.symbol,
        .markdown-content pre .token.deleted {
            color: var(--code-number);
        }
        
        .markdown-content pre .token.selector,
        .markdown-content pre .token.attr-name,
        .markdown-content pre .token.string,
        .markdown-content pre .token.char,
        .markdown-content pre .token.builtin,
        .markdown-content pre .token.inserted {
            color: var(--code-string);
        }
        
        .markdown-content pre .token.operator,
        .markdown-content pre .token.entity,
        .markdown-content pre .token.url,
        .markdown-content pre .language-css .token.string,
        .markdown-content pre .style .token.string {
            color: var(--code-text);
        }
        
        .markdown-content pre .token.atrule,
        .markdown-content pre .token.attr-value,
        .markdown-content pre .token.keyword {
            color: var(--code-keyword);
        }
        
        .markdown-content pre .token.function,
        .markdown-content pre .token.class-name {
            color: var(--code-function);
        }
        
        .markdown-content pre .token.regex,
        .markdown-content pre .token.important,
        .markdown-content pre .token.variable {
            color: var(--code-number);
        }
        
        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border-radius: 1rem;
            overflow: hidden;
        }
        
        .markdown-content th, .markdown-content td {
            border: 1px solid var(--outline-variant);
            padding: 0.8rem;
            text-align: right;
        }
        
        .markdown-content th {
            background: var(--secondary-container);
            font-weight: 600;
            color: var(--on-secondary-container);
        }
        
        .markdown-content tr:nth-child(even) {
            background: var(--surface-variant);
        }
        
        .markdown-content img {
            max-width: 100%;
            height: auto;
            border-radius: 1rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .markdown-content img:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }
        
        .markdown-content a {
            color: var(--primary);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .markdown-content a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            right: 0;
            width: 0;
            height: 2px;
            background: var(--primary);
            transition: width 0.3s ease;
        }
        
        .markdown-content a:hover {
            color: var(--primary-container);
        }
        
        .markdown-content a:hover::after {
            width: 100%;
        }
        
        /* نوار کناری */
        .sidebar-section {
            background: var(--surface);
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }
        
        .sidebar-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--on-surface);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* تگ‌ها */
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .tag {
            background: var(--secondary-container);
            color: var(--on-secondary-container);
            padding: 0.4rem 0.8rem;
            border-radius: 1rem;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .tag::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .tag:hover::before {
            width: 100px;
            height: 100px;
        }
        
        .tag:hover {
            background: var(--primary);
            color: var(--on-primary);
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 8px rgba(103, 80, 164, 0.3);
        }
        
        .tag.active {
            background: var(--primary);
            color: var(--on-primary);
            animation: pulse 2s infinite;
        }
        
        /* فهرست مطالب */
        .toc {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }
        
        .toc::-webkit-scrollbar {
            width: 6px;
        }
        
        .toc::-webkit-scrollbar-track {
            background: var(--surface-variant);
            border-radius: 3px;
        }
        
        .toc::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }
        
        .toc-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--outline-variant);
            transition: all 0.3s ease;
        }
        
        .toc-item:hover {
            padding-right: 0.5rem;
        }
        
        .toc-item:last-child {
            border-bottom: none;
        }
        
        .toc-link {
            color: var(--on-surface-variant);
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .toc-link::before {
            content: '▶';
            position: absolute;
            right: -1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.7rem;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        .toc-link:hover {
            color: var(--primary);
            padding-right: 0.5rem;
        }
        
        .toc-link:hover::before {
            opacity: 1;
            right: -1.5rem;
        }
        
        .toc-link.active {
            color: var(--primary);
            font-weight: 600;
            padding-right: 0.5rem;
        }
        
        .toc-link.active::before {
            opacity: 1;
            right: -1.5rem;
        }
        
        /* اطلاعات مقاله */
        .meta-info {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--on-surface-variant);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .meta-item:hover {
            color: var(--primary);
            transform: translateX(-5px);
        }
        
        .meta-item i {
            color: var(--primary);
            transition: all 0.3s ease;
        }
        
        .meta-item:hover i {
            transform: scale(1.2);
        }
        
        /* دکمه‌های شناور */
        .fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary);
            color: var(--on-primary);
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            transition: all 0.3s ease;
            z-index: 100;
            animation: float 3s ease-in-out infinite;
        }
        
        .fab:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            animation: glow 2s ease-in-out infinite;
        }
        
        /* منوی انتخاب متن */
        .text-selection-menu {
            position: fixed;
            background: var(--surface);
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 0.5rem;
            display: none;
            z-index: 1000;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .text-selection-menu button {
            background: none;
            border: none;
            border-radius: 0.3rem;
            padding: 0.5rem;
            color: var(--on-surface);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
            text-align: right;
        }
        
        .text-selection-menu button:hover {
            background: var(--surface-variant);
            color: var(--primary);
        }
        
        /* مودال‌ها */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease forwards;
        }
        
        .modal-content {
            background: var(--surface);
            padding: 2rem;
            border-radius: 2rem;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease forwards;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
        }
        
        .close-button {
            position: absolute;
            top: 15px;
            left: 20px;
            color: var(--outline);
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-button:hover {
            color: var(--on-surface);
            transform: rotate(90deg);
        }
        
        /* اعلان‌ها - غیرفعال شده */
        .toast-container {
            display: none; /* غیرفعال کردن اعلان‌ها */
        }
        
        /* تم‌های رنگی */
        .theme-selector {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .theme-option:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .theme-option.active {
            border-color: var(--on-surface);
            transform: scale(1.2);
        }
        
        .theme-option.active::after {
            content: '✓';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.5);
        }
        
        .theme-default { background: var(--primary); }
        .theme-blue { background: var(--theme-blue); }
        .theme-green { background: var(--theme-green); }
        .theme-red { background: var(--theme-red); }
        .theme-orange { background: var(--theme-orange); }
        .theme-purple { background: var(--theme-purple); }
        .theme-teal { background: var(--theme-teal); }
        .theme-amber { background: var(--theme-amber); }
        .theme-pink { background: var(--theme-pink); }
        .theme-indigo { background: var(--theme-indigo); }
        
        /* حالت‌های نمایش */
        .view-mode-controls {
            display: flex;
            gap: 0.5rem;
        }
        
        .view-mode-btn {
            background: var(--surface-variant);
            color: var(--on-surface-variant);
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .view-mode-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .view-mode-btn:hover::before {
            width: 100px;
            height: 100px;
        }
        
        .view-mode-btn:hover {
            background: var(--primary);
            color: var(--on-primary);
            transform: translateY(-2px);
        }
        
        .view-mode-btn.active {
            background: var(--primary);
            color: var(--on-primary);
            animation: pulse 2s infinite;
        }
        
        /* حالت خواندن */
        body.reading-mode .sidebar {
            display: none;
        }
        
        body.reading-mode .markdown-content {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.1rem;
            line-height: 2;
        }
        
        /* هایلایت جستجو */
        .search-highlight {
            background: rgba(255, 255, 0, 0.4);
            padding: 0 2px;
            border-radius: 2px;
            animation: highlight 1s ease;
        }
        
        /* کپی کد */
        .copy-code-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--primary);
            color: var(--on-primary);
            border: none;
            border-radius: 0.5rem;
            padding: 0.4rem 0.8rem;
            font-size: 0.8rem;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
        }
        
        pre:hover .copy-code-btn {
            opacity: 1;
        }
        
        .copy-code-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(103, 80, 164, 0.4);
        }
        
        /* لایت‌باکس تصاویر */
        .lightbox {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            cursor: pointer;
            animation: fadeIn 0.3s ease;
        }
        
        .lightbox img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 1rem;
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2);
            animation: slideUp 0.5s ease;
        }
        
        /* تنظیمات پیشرفته */
        .settings-section {
            margin-bottom: 1.5rem;
        }
        
        .settings-section h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: var(--on-surface);
        }
        
        .settings-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .settings-option:hover {
            background: var(--surface-variant);
        }
        
        .settings-option label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        
        .settings-option input[type="checkbox"] {
            width: 1.2rem;
            height: 1.2rem;
            cursor: pointer;
        }
        
        .settings-option input[type="range"] {
            width: 150px;
            cursor: pointer;
        }
        
        .settings-option select {
            background: var(--surface-variant);
            color: var(--on-surface);
            border: 1px solid var(--outline-variant);
            border-radius: 0.3rem;
            padding: 0.4rem 0.8rem;
            cursor: pointer;
        }
        
        /* ریسپانسیو */
        @media (max-width: 1024px) {
            .content-wrapper {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                order: 2;
                position: static;
                max-height: none;
            }
            
            .main-content {
                order: 1;
            }
        }
        
        @media (max-width: 768px) {
    /* کدهای موجود قبلی */
    
    /* مخفی کردن دکمه بازگشت به خانه در موبایل */
    .header-content > a:first-child {
        display: none;
    }
 
            
            .header-content {
                flex-direction: row;
                gap: 0.5rem;
            }
            
            .header-title {
                font-size: 1.1rem;
                text-align: center;
                max-width: 60%;
            }
            
            .toolbar {
                justify-content: center;
                margin-top: 0.5rem;
            }
            
            .search-container {
                max-width: 100%;
            }
            
            .markdown-content {
                padding: 1.5rem;
            }
            
            .markdown-content h1 {
                font-size: 1.8rem;
            }
            
            .markdown-content h2 {
                font-size: 1.6rem;
            }
            
            .fab {
                bottom: 15px;
                right: 15px;
                width: 48px;
                height: 48px;
            }
            
            .text-selection-menu {
                flex-direction: row;
                bottom: auto;
                top: -50px;
            }
            
            /* دکمه کنار سایدبار برای موبایل */
            .sidebar-toggle {
                display: block;
                position: fixed;
                top: 80px;
                right: 10px;
                z-index: 101;
                background: var(--primary);
                color: var(--on-primary);
                border: none;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            }
            
            .sidebar {
                transform: translateX(100%);
                transition: transform 0.3s ease;
                position: fixed;
                top: 70px;
                right: 0;
                width: 80%;
                max-width: 300px;
                height: calc(100vh - 70px);
                z-index: 100;
                box-shadow: -2px 0 5px rgba(0,0,0,0.1);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 99;
            }
            
            .sidebar-overlay.active {
                display: block;
            }
        }
        
        @media (min-width: 769px) {
            .sidebar-toggle, .sidebar-overlay {
                display: none;
            }
        }
        
        /* دسترسی‌پذیری */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: var(--primary);
            color: var(--on-primary);
            padding: 8px;
            text-decoration: none;
            border-radius: 0 0 4px 0;
            z-index: 100;
            transition: top 0.3s ease;
        }
        
        .skip-link:focus {
            top: 0;
        }
        
        /* انیمیشن‌های لودینگ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            flex-direction: column;
            gap: 1rem;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--outline-variant);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* چاپ */
        @media print {
            body {
                background: white;
                color: black;
            }
            
            .container {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
            
            .header, .toolbar, .sidebar, .fab, .reading-progress {
                display: none;
            }
            
            .markdown-content {
                box-shadow: none;
                padding: 0;
            }
        }
        
        /* شماره خطوط کد */
        .line-numbers .line-numbers-rows {
            position: absolute;
            pointer-events: none;
            top: 1em;
            font-size: 100%;
            left: -3.8em;
            width: 3em;
            letter-spacing: -1px;
            border-right: 1px solid #999;
            user-select: none;
        }
        
        .line-numbers-rows > span:before {
            content: counter(linenumber);
            counter-increment: linenumber;
            display: block;
            text-align: right;
            color: #999;
        }
        
        /* ویژگی‌های جدید */
        .feature-card {
            background: var(--surface);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }
        
        .feature-header {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .feature-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-container);
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }
        
        .feature-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--on-surface);
        }
        
        .feature-description {
            color: var(--on-surface-variant);
            line-height: 1.6;
        }
        
        .feature-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: auto;
        }
        
        /* دکمه‌های اضافی */
        .extra-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: var(--secondary-container);
            color: var(--on-secondary-container);
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .action-btn:hover {
            background: var(--primary);
            color: var(--on-primary);
            transform: translateY(-2px);
        }
        
        /* نشانگر پیشرفت */
        .progress-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--surface);
            border-radius: 1rem;
            padding: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 90;
            max-width: 200px;
        }
        
        .progress-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--on-surface);
        }
        
        .progress-bar {
            height: 8px;
            background: var(--surface-variant);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            font-size: 0.8rem;
            color: var(--on-surface-variant);
            text-align: center;
        }
        
        /* منوی سریع */
        .quick-menu {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: var(--surface);
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            z-index: 90;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .quick-menu.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
        
        .quick-menu-item {
            background: none;
            border: none;
            border-radius: 0.5rem;
            padding: 0.8rem;
            color: var(--on-surface);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
            text-align: right;
        }
        
        .quick-menu-item:hover {
            background: var(--surface-variant);
            color: var(--primary);
        }
        
        /* پنل تنظیمات سریع */
        .quick-settings {
            position: fixed;
            top: 80px;
            left: 20px;
            background: var(--surface);
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 1rem;
            z-index: 90;
            max-width: 250px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            pointer-events: none;
        }
        
        .quick-settings.active {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }
        
        .quick-settings-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--on-surface);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .quick-setting {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.8rem;
        }
        
        .quick-setting label {
            font-size: 0.9rem;
            color: var(--on-surface-variant);
        }
        
        .quick-setting input[type="checkbox"] {
            width: 1rem;
            height: 1rem;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- نوار پیشرفت خواندن -->
    <div class="reading-progress">
        <div class="reading-progress-bar" id="readingProgressBar"></div>
    </div>
    
    <!-- لینک پرش به محتوا برای دسترسی‌پذیری -->
    <a href="#content" class="skip-link">پرش به محتوا</a>
    
    <!-- کانتینر اعلان‌ها - غیرفعال شده -->
    <div class="toast-container" id="toastContainer" aria-live="polite" aria-atomic="true"></div>
    
    <!-- منوی انتخاب متن -->
    <div class="text-selection-menu" id="textSelectionMenu">
        <button onclick="copySelectedText()">
            <i class="fas fa-copy"></i>
            کپی متن
        </button>
        <button onclick="searchSelectedText()">
            <i class="fas fa-search"></i>
            جستجو
        </button>
        <button onclick="highlightSelectedText()">
            <i class="fas fa-highlighter"></i>
            هایلایت
        </button>
        <button onclick="speakSelectedText()">
            <i class="fas fa-volume-up"></i>
            خواندن
        </button>
    </div>
    
    <!-- هدر -->
    <header class="header">
        <div class="header-content">
            <a href="index.html" class="btn btn-primary">
                <i class="fas fa-home"></i>
                صفحه اصلی
            </a>
            <h1 class="header-title" id="articleTitle">در حال بارگذاری...</h1>
            <div class="toolbar-section">
                <button class="btn btn-icon" onclick="toggleDarkMode()" title="تغییر حالت تاریک">
                    <i class="fas fa-moon"></i>
                </button>
                <button class="btn btn-icon" onclick="shareArticle()" title="اشتراک‌گذاری">
                    <i class="fas fa-share-alt"></i>
                </button>
                <button class="btn btn-icon" onclick="window.print()" title="چاپ">
                    <i class="fas fa-print"></i>
                </button>
                <button class="btn btn-icon" onclick="downloadMarkdown()" title="دانلود">
                    <i class="fas fa-download"></i>
                </button>
            </div>
        </div>
    </header>
    
    <!-- نوار ابزار -->
    <div class="toolbar">
        <div class="toolbar-section">
            <!-- جستجو -->
            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="جستجو در مقاله..." aria-label="جستجو در مقاله">
                <button class="search-btn" onclick="searchInArticle()" aria-label="جستجو">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
        
        <div class="toolbar-section">
            <!-- حالت‌های نمایش -->
            <div class="view-mode-controls">
                <button class="view-mode-btn active" data-mode="normal" onclick="setViewMode('normal', this)" title="حالت عادی">
                    <i class="fas fa-file-alt"></i>
                </button>
                <button class="view-mode-btn" data-mode="reading" onclick="setViewMode('reading', this)" title="حالت خواندن">
                    <i class="fas fa-book-open"></i>
                </button>
            </div>
            
            <!-- کنترل فونت -->
            <button class="btn btn-icon" onclick="decreaseFontSize()" title="کاهش اندازه فونت">
                <i class="fas fa-minus"></i>
            </button>
            <button class="btn btn-icon" onclick="increaseFontSize()" title="افزایش اندازه فونت">
                <i class="fas fa-plus"></i>
            </button>
            
            <!-- تنظیمات -->
            <button class="btn btn-icon" onclick="openModal('settingsModal')" title="تنظیمات">
                <i class="fas fa-cog"></i>
            </button>
        </div>
    </div>
    
    <!-- محتوای اصلی -->
    <div class="container">
        <div class="content-wrapper" id="content">
            <!-- محتوای اصلی -->
            <main class="main-content">
                <div id="markdownContent" class="markdown-content">
                    <div class="loading flex flex-col items-center justify-center py-16">
                        <div class="spinner mb-4"></div>
                        <p class="text-gray-600">در حال بارگذاری مقاله...</p>
                    </div>
                </div>
                
                <!-- ویژگی‌های جدید -->
                <div class="extra-actions">
                    <button class="action-btn" onclick="toggleQuickSettings()">
                        <i class="fas fa-sliders-h"></i>
                        تنظیمات سریع
                    </button>
                    <button class="action-btn" onclick="toggleQuickMenu()">
                        <i class="fas fa-ellipsis-v"></i>
                        منوی سریع
                    </button>
                    <button class="action-btn" onclick="exportToPDF()">
                        <i class="fas fa-file-pdf"></i>
                        خروجی PDF
                    </button>
                    <button class="action-btn" onclick="toggleFullscreen()">
                        <i class="fas fa-expand"></i>
                        تمام صفحه
                    </button>
                </div>
            </main>
            
            <!-- نوار کناری -->
            <aside class="sidebar" id="sidebar">
                <!-- فهرست مطالب -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-list"></i>
                        فهرست مطالب
                    </h3>
                    <div class="toc" id="tableOfContents">
                        <!-- فهرست مطالب از طریق جاوا اسکریپت تولید می‌شود -->
                    </div>
                </div>
                
                <!-- تگ‌ها -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-tags"></i>
                        تگ‌ها
                    </h3>
                    <div class="tag-cloud" id="tagsCloud">
                        <!-- تگ‌ها از طریق جاوا اسکریپت تولید می‌شوند -->
                    </div>
                </div>
                
                <!-- اطلاعات مقاله -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-info-circle"></i>
                        اطلاعات مقاله
                    </h3>
                    <div class="meta-info">
                        <div class="meta-item">
                            <i class="fas fa-calendar"></i>
                            <span id="metaDate">در حال بارگذاری...</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-clock"></i>
                            <span id="metaReadingTime">در حال بارگذاری...</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-file-word"></i>
                            <span id="metaWordCount">در حال بارگذاری...</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-eye"></i>
                            <span id="metaViews">در حال بارگذاری...</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-star"></i>
                            <span id="metaRating">در حال بارگذاری...</span>
                        </div>
                    </div>
                </div>
                
                <!-- ویژگی‌های جدید -->
                <div class="sidebar-section">
                    <h3 class="sidebar-title">
                        <i class="fas fa-magic"></i>
                        ویژگی‌های جدید
                    </h3>
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">
                                <i class="fas fa-bookmark"></i>
                            </div>
                            <div class="feature-title">ذخیره مکان</div>
                        </div>
                        <div class="feature-description">
                            مکان فعلی خود را در مقاله ذخیره کنید تا بعداً به آن برگردید.
                        </div>
                        <div class="feature-actions">
                            <button class="btn btn-primary" onclick="saveBookmark()">
                                <i class="fas fa-save"></i>
                                ذخیره مکان
                            </button>
                        </div>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-header">
                            <div class="feature-icon">
                                <i class="fas fa-highlighter"></i>
                            </div>
                            <div class="feature-title">یادداشت‌ها</div>
                        </div>
                        <div class="feature-description">
                            یادداشت‌های خود را برای بخش‌های مهم مقاله ایجاد کنید.
                        </div>
                        <div class="feature-actions">
                            <button class="btn btn-primary" onclick="openNotesModal()">
                                <i class="fas fa-sticky-note"></i>
                                یادداشت‌ها
                            </button>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </div>
    
    <!-- دکمه شناور -->
    <button class="fab" onclick="scrollToTop()" title="بازگشت به بالا">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <!-- دکمه کنار سایدبار برای موبایل -->
    <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- لایه سایدبار برای موبایل -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>
    
    <!-- لایت‌باکس تصاویر -->
    <div class="lightbox" id="lightbox" onclick="closeLightbox()">
        <img src="" alt="" id="lightboxImage">
    </div>
    
    <!-- منوی سریع -->
    <div class="quick-menu" id="quickMenu">
        <button class="quick-menu-item" onclick="toggleDarkMode()">
            <i class="fas fa-moon"></i>
            حالت تاریک
        </button>
        <button class="quick-menu-item" onclick="setViewMode('reading')">
            <i class="fas fa-book-open"></i>
            حالت خواندن
        </button>
        <button class="quick-menu-item" onclick="shareArticle()">
            <i class="fas fa-share-alt"></i>
            اشتراک‌گذاری
        </button>
        <button class="quick-menu-item" onclick="downloadMarkdown()">
            <i class="fas fa-download"></i>
            دانلود
        </button>
        <button class="quick-menu-item" onclick="exportToPDF()">
            <i class="fas fa-file-pdf"></i>
            خروجی PDF
        </button>
    </div>
    
    <!-- پنل تنظیمات سریع -->
    <div class="quick-settings" id="quickSettings">
        <h3 class="quick-settings-title">
            <i class="fas fa-sliders-h"></i>
            تنظیمات سریع
        </h3>
        <div class="quick-setting">
            <label>حالت تاریک</label>
            <input type="checkbox" id="quickDarkMode" onchange="toggleDarkMode()">
        </div>
        <div class="quick-setting">
            <label>حالت خواندن</label>
            <input type="checkbox" id="quickReadingMode" onchange="toggleReadingMode()">
        </div>
        <div class="quick-setting">
            <label>هایلایت کد</label>
            <input type="checkbox" id="quickHighlightCode" checked onchange="toggleCodeHighlighting()">
        </div>
        <div class="quick-setting">
            <label>بارگذاری تصاویر</label>
            <input type="checkbox" id="quickLoadImages" checked onchange="toggleImageLoading()">
        </div>
    </div>
    
    <!-- نشانگر پیشرفت -->
    <div class="progress-indicator" id="progressIndicator">
        <div class="progress-title">پیشرفت خواندن</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">0%</div>
    </div>
    
    <!-- مودال تنظیمات -->
    <div id="settingsModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="settingsModalTitle">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal('settingsModal')" aria-label="بستن">&times;</span>
            <h3 id="settingsModalTitle" class="text-2xl font-bold mb-4">تنظیمات</h3>
            
            <!-- تم رنگی -->
            <div class="settings-section">
                <h4>تم رنگی</h4>
                <div class="theme-selector">
                    <div class="theme-option theme-default active" onclick="setTheme('default')"></div>
                    <div class="theme-option theme-blue" onclick="setTheme('blue')"></div>
                    <div class="theme-option theme-green" onclick="setTheme('green')"></div>
                    <div class="theme-option theme-red" onclick="setTheme('red')"></div>
                    <div class="theme-option theme-orange" onclick="setTheme('orange')"></div>
                    <div class="theme-option theme-purple" onclick="setTheme('purple')"></div>
                    <div class="theme-option theme-teal" onclick="setTheme('teal')"></div>
                    <div class="theme-option theme-amber" onclick="setTheme('amber')"></div>
                    <div class="theme-option theme-pink" onclick="setTheme('pink')"></div>
                    <div class="theme-option theme-indigo" onclick="setTheme('indigo')"></div>
                </div>
            </div>
            
            <!-- تنظیمات نمایش -->
            <div class="settings-section">
                <h4>تنظیمات نمایش</h4>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="justifyText" checked>
                        تراز متن
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="lineNumbers" checked>
                        شماره خطوط کد
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="loadImages" checked>
                        بارگذاری تصاویر
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        اندازه فونت: <span id="fontSizeValue">16</span>px
                    </label>
                    <input type="range" id="fontSizeSlider" min="12" max="24" value="16" step="1" onchange="setFontSizeFromSlider(this.value)">
                </div>
            </div>
            
            <!-- تنظیمات پیشرفته -->
            <div class="settings-section">
                <h4>تنظیمات پیشرفته</h4>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="autoSave" checked>
                        ذخیره خودکار موقعیت خواندن
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="smoothScroll" checked>
                        اسکرول نرم
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="highlightCode" checked>
                        هایلایت کد
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="showReadingProgress" checked>
                        نمایش نوار پیشرفت خواندن
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="enableAnimations" checked>
                        فعال‌سازی انیمیشن‌ها
                    </label>
                </div>
            </div>
            
            <!-- تنظیمات دسترسی‌پذیری -->
            <div class="settings-section">
                <h4>دسترسی‌پذیری</h4>
                <div class="settings-option">
                    <label>
                        <input type="checkbox" id="highContrast">
                        کنتراست بالا
                    </label>
                </div>
                <div class="settings-option">
                    <label>
                        اندازه متن: <span id="textSizeValue">100</span>%
                    </label>
                    <input type="range" id="textSizeSlider" min="80" max="150" value="100" step="10" onchange="setTextSize(this.value)">
                </div>
                <div class="settings-option">
                    <label>
                        فاصله خطوط: <span id="lineHeightValue">1.8</span>
                    </label>
                    <input type="range" id="lineHeightSlider" min="1.2" max="2.5" value="1.8" step="0.1" onchange="setLineHeight(this.value)">
                </div>
            </div>
            
            <!-- مدیریت داده‌ها -->
            <div class="settings-section">
                <h4>مدیریت داده‌ها</h4>
                <button class="btn btn-primary w-full mb-2" onclick="exportSettings()">
                    <i class="fas fa-download"></i>
                    خروجی تنظیمات
                </button>
                <button class="btn w-full mb-2" onclick="importSettings()">
                    <i class="fas fa-upload"></i>
                    ورود تنظیمات
                </button>
                <button class="btn w-full" onclick="resetSettings()" style="background: var(--error-container); color: var(--on-error-container);">
                    <i class="fas fa-redo"></i>
                    بازنشانی تنظیمات
                </button>
            </div>
            
            <button class="btn btn-primary w-full mt-4" onclick="saveSettings()">
                <i class="fas fa-save"></i>
                ذخیره تنظیمات
            </button>
        </div>
    </div>
    
    <script>
        // متغیرهای اصلی
        let currentFile = null;
        let currentContent = null;
        let isDarkMode = false;
        let fontSize = 16;
        let currentViewMode = 'normal';
        let searchHighlights = [];
        let currentSearchIndex = 0;
        let allFileNames = [];
        let selectedText = '';
        let sidebarOpen = false;
        let quickMenuOpen = false;
        let quickSettingsOpen = false;
        
        // سیستم تگ‌ها
        const tagSystem = {
            // تگ‌های کامل با کلمات کلیدی
            allTags: {
                // توزیع‌ها
                'ubuntu': {
                    name: 'اوبونتو',
                    keywords: ['ubuntu', 'اوبونتو', 'ابونتو', 'ubunto']
                },
                'arch': {
                    name: 'آرچ لینوکس',
                    keywords: ['arch', 'آرچ', 'ارچ', 'arch linux']
                },
                'fedora': {
                    name: 'فدورا',
                    keywords: ['fedora', 'فدورا', 'fedora linux']
                },
                'debian': {
                    name: 'دبیان',
                    keywords: ['debian', 'دبیان', 'دبیان گنو/لینوکس']
                },
                'centos': {
                    name: 'سن‌تی‌او‌اس',
                    keywords: ['centos', 'سنتوس', 'cent os']
                },
                'opensuse': {
                    name: 'اوپن‌سوزه',
                    keywords: ['opensuse', 'اوپن سوزه', 'suse', 'سوزه']
                },
                'mint': {
                    name: 'لینوکس مینت',
                    keywords: ['mint', 'مینت', 'linux mint']
                },
                'manjaro': {
                    name: 'مانجارو',
                    keywords: ['manjaro', 'مانجارو', 'manjaro linux']
                },
                'elementary': {
                    name: 'المنتری',
                    keywords: ['elementary', 'المنتری', 'elementary os']
                },
                'zorin': {
                    name: 'زورین',
                    keywords: ['zorin', 'زورین', 'zorin os']
                },
                
                // دستورات
                'bash': {
                    name: 'بش',
                    keywords: ['bash', 'بش', 'shell', 'شل', 'terminal', 'ترمینال']
                },
                'grep': {
                    name: 'گریپ',
                    keywords: ['grep', 'گریپ', 'جستجو در متن']
                },
                'sed': {
                    name: 'سد',
                    keywords: ['sed', 'سد', 'ویرایش جریانی']
                },
                'awk': {
                    name: 'آوک',
                    keywords: ['awk', 'آوک', 'پردازش متن']
                },
                'find': {
                    name: 'فایند',
                    keywords: ['find', 'فایند', 'یافتن فایل']
                },
                'chmod': {
                    name: 'چمود',
                    keywords: ['chmod', 'چمود', 'تغییر مجوز']
                },
                'chown': {
                    name: 'چاون',
                    keywords: ['chown', 'چاون', 'تغییر مالک']
                },
                'ssh': {
                    name: 'اس‌اس‌اچ',
                    keywords: ['ssh', 'اس اس اچ', 'اتصال امن']
                },
                'scp': {
                    name: 'اس‌سی‌پی',
                    keywords: ['scp', 'اس سی پی', 'کپی امن']
                },
                'rsync': {
                    name: 'آرسینک',
                    keywords: ['rsync', 'آر سینک', 'همگام‌سازی از راه دور']
                },
                
                // سرورها
                'apache': {
                    name: 'آپاچی',
                    keywords: ['apache', 'آپاچی', 'httpd', 'وب سرور']
                },
                'nginx': {
                    name: 'انجین‌اکس',
                    keywords: ['nginx', 'انجین اکس', 'وب سرور']
                },
                'mysql': {
                    name: 'مای‌اس‌کیوال',
                    keywords: ['mysql', 'مای اس کیوال', 'دیتابیس']
                },
                'postgresql': {
                    name: 'پستگرس‌کیوال',
                    keywords: ['postgresql', 'پستگرس', 'دیتابیس']
                },
                'mongodb': {
                    name: 'مانگو‌دی‌بی',
                    keywords: ['mongodb', 'مانگو دی بی', 'دیتابیس']
                },
                'redis': {
                    name: 'ریدیس',
                    keywords: ['redis', 'ریدیس', 'حافظه نهان']
                },
                'ftp': {
                    name: 'اف‌تی‌پی',
                    keywords: ['ftp', 'اف تی پی', 'انتقال فایل']
                },
                'samba': {
                    name: 'سامبا',
                    keywords: ['samba', 'سامبا', 'اشتراک فایل']
                },
                'bind': {
                    name: 'بایند',
                    keywords: ['bind', 'بایند', 'دی‌ان‌اس']
                },
                'postfix': {
                    name: 'پستفیکس',
                    keywords: ['postfix', 'پستفیکس', 'سرور ایمیل']
                },
                
                // محیط دسکتاپ
                'gnome': {
                    name: 'گنوم',
                    keywords: ['gnome', 'گنوم', 'محیط دسکتاپ']
                },
                'kde': {
                    name: 'کدی‌ای',
                    keywords: ['kde', 'کدی ای', 'پلاسما', 'محیط دسکتاپ']
                },
                'xfce': {
                    name: 'اکس‌اف‌سی‌ای',
                    keywords: ['xfce', 'اکس اف سی ای', 'محیط دسکتاپ']
                },
                'lxde': {
                    name: 'ال‌اکس‌دی‌ای',
                    keywords: ['lxde', 'ال اکس دی ای', 'محیط دسکتاپ']
                },
                'cinnamon': {
                    name: 'سینامون',
                    keywords: ['cinnamon', 'سینامون', 'محیط دسکتاپ']
                },
                'mate': {
                    name: 'میت',
                    keywords: ['mate', 'میت', 'محیط دسکتاپ']
                },
                'budgie': {
                    name: 'باجی',
                    keywords: ['budgie', 'باجی', 'محیط دسکتاپ']
                },
                'pantheon': {
                    name: 'پانتئون',
                    keywords: ['pantheon', 'پانتئون', 'محیط دسکتاپ']
                },
                'deepin': {
                    name: 'دیپین',
                    keywords: ['deepin', 'دیپین', 'محیط دسکتاپ']
                },
                'unity': {
                    name: 'یونیتی',
                    keywords: ['unity', 'یونیتی', 'محیط دسکتاپ']
                },
                
                // امنیت
                'firewall': {
                    name: 'فایروال',
                    keywords: ['firewall', 'فایروال', 'iptables', 'ufw']
                },
                'selinux': {
                    name: 'اس‌ای‌لینوکس',
                    keywords: ['selinux', 'اس ای لینوکس', 'امنیت']
                },
                'apparmor': {
                    name: 'اپ‌آرمور',
                    keywords: ['apparmor', 'اپ آرمور', 'امنیت']
                },
                'fail2ban': {
                    name: 'فیل‌تو‌بن',
                    keywords: ['fail2ban', 'فیل تو بن', 'امنیت']
                },
                'clamav': {
                    name: 'کلماو',
                    keywords: ['clamav', 'کلماو', 'آنتی‌ویروس']
                },
                'gpg': {
                    name: 'جی‌پی‌جی',
                    keywords: ['gpg', 'جی پی جی', 'رمزنگاری']
                },
                'openssl': {
                    name: 'اوپن‌اس‌اس‌ال',
                    keywords: ['openssl', 'اوپن اس اس ال', 'رمزنگاری']
                },
                'vpn': {
                    name: 'وی‌پی‌ان',
                    keywords: ['vpn', 'وی پی ان', 'شبکه خصوصی مجازی']
                },
                'tor': {
                    name: 'تور',
                    keywords: ['tor', 'تور', 'ناشناس بودن']
                },
                'audit': {
                    name: 'ادیت',
                    keywords: ['audit', 'ادیت', 'بازرسی امنیتی']
                },
                
                // شبکه
                'networking': {
                    name: 'شبکه',
                    keywords: ['networking', 'شبکه', 'network', 'نتورک']
                },
                'netplan': {
                    name: 'نت‌پلن',
                    keywords: ['netplan', 'نت پلن', 'پیکربندی شبکه']
                },
                'networkmanager': {
                    name: 'مدیریت شبکه',
                    keywords: ['networkmanager', 'مدیریت شبکه', 'nmcli']
                },
                'dhcp': {
                    name: 'دی‌اچ‌سی‌پی',
                    keywords: ['dhcp', 'دی اچ سی پی', 'اختصاص آی‌پی']
                },
                'dns': {
                    name: 'دی‌ان‌اس',
                    keywords: ['dns', 'دی ان اس', 'سیستم نام دامنه']
                },
                'proxy': {
                    name: 'پراکسی',
                    keywords: ['proxy', 'پراکسی', 'میانجی']
                },
                'vlan': {
                    name: 'ولان',
                    keywords: ['vlan', 'ولان', 'شبکه محلی مجازی']
                },
                'bridge': {
                    name: 'بریج',
                    keywords: ['bridge', 'بریج', 'پل شبکه']
                },
                'bonding': {
                    name: 'باندینگ',
                    keywords: ['bonding', 'باندینگ', 'اتصال چند شبکه']
                },
                'wifi': {
                    name: 'وای‌فای',
                    keywords: ['wifi', 'وای فای', 'بی‌سیم']
                },
                
                // توسعه
                'git': {
                    name: 'گیت',
                    keywords: ['git', 'گیت', 'کنترل نسخه']
                },
                'github': {
                    name: 'گیت‌هاب',
                    keywords: ['github', 'گیت هاب', 'مخزن کد']
                },
                'docker': {
                    name: 'داکر',
                    keywords: ['docker', 'داکر', 'کانتینر']
                },
                'kubernetes': {
                    name: 'کوبرنتیز',
                    keywords: ['kubernetes', 'کوبرنتیز', 'کوبز', 'ارکستر کانتینر']
                },
                'vagrant': {
                    name: 'واگرنت',
                    keywords: ['vagrant', 'واگرنت', 'ماشین مجازی']
                },
                'ansible': {
                    name: 'انسیبل',
                    keywords: ['ansible', 'انسیبل', 'اتوماسیون']
                },
                'jenkins': {
                    name: 'جنکینز',
                    keywords: ['jenkins', 'جنکینز', 'یکپارچه‌سازی']
                },
                'npm': {
                    name: 'ان‌پی‌ام',
                    keywords: ['npm', 'ان پی ام', 'مدیریت پکیج']
                },
                'yarn': {
                    name: 'یارن',
                    keywords: ['yarn', 'یارن', 'مدیریت پکیج']
                },
                'composer': {
                    name: 'کامپوزر',
                    keywords: ['composer', 'کامپوزر', 'مدیریت پکیج']
                },
                'gradle': {
                    name: 'گریدل',
                    keywords: ['gradle', 'گریدل', 'ساخت خودکار']
                },
                
                // سخت‌افزار
                'drivers': {
                    name: 'درایورها',
                    keywords: ['drivers', 'درایور', 'راه‌انداز']
                },
                'gpu': {
                    name: 'جی‌پی‌یو',
                    keywords: ['gpu', 'جی پی یو', 'کارت گرافیک']
                },
                'cpu': {
                    name: 'سی‌پی‌یو',
                    keywords: ['cpu', 'سی پی یو', 'پردازنده']
                },
                'ram': {
                    name: 'رم',
                    keywords: ['ram', 'رم', 'حافظه']
                },
                'storage': {
                    name: 'ذخیره‌سازی',
                    keywords: ['storage', 'ذخیره سازی', 'هارد دیسک', 'اس‌اس‌دی']
                },
                'usb': {
                    name: 'یواس‌بی',
                    keywords: ['usb', 'یو اس بی', 'اتصال یواس‌بی']
                },
                'bluetooth': {
                    name: 'بلوتوث',
                    keywords: ['bluetooth', 'بلوتوث', 'اتصال بلوتوث']
                },
                'printer': {
                    name: 'پرینتر',
                    keywords: ['printer', 'پرینتر', 'چاپگر']
                },
                'scanner': {
                    name: 'اسکنر',
                    keywords: ['scanner', 'اسکنر', 'اسکن']
                },
                'webcam': {
                    name: 'وب‌کم',
                    keywords: ['webcam', 'وب کم', 'دوربین وب']
                },
                
                // مجازی‌سازی
                'virtualbox': {
                    name: 'ورچوال‌باکس',
                    keywords: ['virtualbox', 'ورچوال باکس', 'ماشین مجازی']
                },
                'vmware': {
                    name: 'وی‌ام‌ور',
                    keywords: ['vmware', 'وی ام ور', 'ماشین مجازی']
                },
                'kvm': {
                    name: 'کی‌وی‌ام',
                    keywords: ['kvm', 'کی وی ام', 'ماشین مجازی']
                },
                'qemu': {
                    name: 'کیوای‌ام‌یو',
                    keywords: ['qemu', 'کیو ایمو', 'شبیه‌ساز']
                },
                'xen': {
                    name: 'زن',
                    keywords: ['xen', 'زن', 'هایپروایزر']
                },
                'hyper-v': {
                    name: 'هایپر-وی',
                    keywords: ['hyper-v', 'هایپر وی', 'هایپروایزر']
                },
                'proxmox': {
                    name: 'پروکس‌موکس',
                    keywords: ['proxmox', 'پروکس موکس', 'هایپروایزر']
                },
                'lxc': {
                    name: 'ال‌اکس‌سی',
                    keywords: ['lxc', 'ال اکس سی', 'کانتینر لینوکس']
                },
                'openvz': {
                    name: 'اوپن‌وی‌زی',
                    keywords: ['openvz', 'اوپن وی زی', 'کانتینر']
                },
                'vagrant': {
                    name: 'واگرنت',
                    keywords: ['vagrant', 'واگرنت', 'محیط توسعه']
                },
                
                // ابر
                'aws': {
                    name: 'ای‌دبلیواس',
                    keywords: ['aws', 'ای دبلیو اس', 'آماzon web services']
                },
                'azure': {
                    name: 'آژور',
                    keywords: ['azure', 'آژور', 'مایکروسافت آژور']
                },
                'gcp': {
                    name: 'جی‌سی‌پی',
                    keywords: ['gcp', 'جی سی پی', 'google cloud platform']
                },
                'openstack': {
                    name: 'اوپن‌استک',
                    keywords: ['openstack', 'اوپن استک', 'ابر خصوصی']
                },
                'cloud-init': {
                    name: 'کلاد-اینیت',
                    keywords: ['cloud-init', 'کلاد اینیت', 'پیکربندی ابری']
                },
                'terraform': {
                    name: 'ترافورم',
                    keywords: ['terraform', 'ترافورم', 'زیرساخت به صورت کد']
                },
                'packer': {
                    name: 'پکر',
                    keywords: ['packer', 'پکر', 'ساخت ماشین ابری']
                },
                'consul': {
                    name: 'کانسول',
                    keywords: ['consul', 'کانسول', 'کشف سرویس']
                },
                'vault': {
                    name: 'ولت',
                    keywords: ['vault', 'ولت', 'مدیریت اسرار']
                },
                'nomad': {
                    name: 'نومد',
                    keywords: ['nomad', 'نومد', 'ارکستر']
                }
            },
            
            // استخراج تگ‌ها از محتوا
            extractTags: function(content) {
                const tags = [];
                const text = content.toLowerCase();
                
                // بررسی تمام تگ‌ها
                for (const [tagId, tagData] of Object.entries(this.allTags)) {
                    for (const keyword of tagData.keywords) {
                        if (text.includes(keyword.toLowerCase())) {
                            tags.push({
                                id: tagId,
                                name: tagData.name
                            });
                            break;
                        }
                    }
                }
                
                // حذف تگ‌های تکراری
                return tags.filter((tag, index, self) =>
                    index === self.findIndex(t => t.id === tag.id)
                );
            },
            
            // دریافت نام تگ بر اساس شناسه
            getTagName: function(tagId) {
                return this.allTags[tagId]?.name || tagId;
            }
        };
        
        // نمایش وضعیت بارگذاری
        function showLoading() {
            document.getElementById('markdownContent').innerHTML = `
                <div class="loading flex flex-col items-center justify-center py-16">
                    <div class="spinner mb-4"></div>
                    <p class="text-gray-600">در حال بارگذاری مقاله...</p>
                </div>
            `;
        }
        
        // افزودن ورودی به لاگ - غیرفعال شده
        function addLogEntry(message, type = 'info') {
            // تابع خالی برای غیرفعال کردن لاگ‌ها
        }
        
        // تابع اصلی برای مقداردهی اولیه
        async function init() {
            console.log('Initializing viewer...');
            loadPreferences();
            showLoading();
            await loadAllFileNames();
            await loadFile();
            setupEventListeners();
            generateTableOfContents();
            updateViewCount();
            setupReadingProgress();
            setupTextSelection();
            setupProgressIndicator();
        }
        
        // بارگذاری تنظیمات
        function loadPreferences() {
            isDarkMode = localStorage.getItem('isDarkMode') === 'true';
            fontSize = parseInt(localStorage.getItem('fontSize') || '16');
            currentViewMode = localStorage.getItem('viewMode') || 'normal';
            
            // اعمال تنظیمات
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('quickDarkMode').checked = true;
            }
            
            // به‌روزرسانی دکمه‌های فعال بدون استفاده از event
            updateViewModeButtons(currentViewMode);
            setViewMode(currentViewMode);
            setFontSize(fontSize);
            
            // بارگذاری تنظیمات پیشرفته
            const settings = JSON.parse(localStorage.getItem('settings') || '{}');
            
            if (settings.theme) {
                setTheme(settings.theme);
            }
            
            if (settings.textSize) {
                document.getElementById('textSizeSlider').value = settings.textSize;
                document.getElementById('textSizeValue').textContent = settings.textSize;
                setTextSize(settings.textSize);
            }
            
            if (settings.lineHeight) {
                document.getElementById('lineHeightSlider').value = settings.lineHeight;
                document.getElementById('lineHeightValue').textContent = settings.lineHeight;
                setLineHeight(settings.lineHeight);
            }
            
            if (settings.justifyText !== undefined) {
                document.getElementById('justifyText').checked = settings.justifyText;
            }
            
            if (settings.lineNumbers !== undefined) {
                document.getElementById('lineNumbers').checked = settings.lineNumbers;
            }
            
            if (settings.loadImages !== undefined) {
                document.getElementById('loadImages').checked = settings.loadImages;
                document.getElementById('quickLoadImages').checked = settings.loadImages;
            }
            
            if (settings.autoSave !== undefined) {
                document.getElementById('autoSave').checked = settings.autoSave;
            }
            
            if (settings.smoothScroll !== undefined) {
                document.getElementById('smoothScroll').checked = settings.smoothScroll;
            }
            
            if (settings.highlightCode !== undefined) {
                document.getElementById('highlightCode').checked = settings.highlightCode;
                document.getElementById('quickHighlightCode').checked = settings.highlightCode;
            }
            
            if (settings.showReadingProgress !== undefined) {
                document.getElementById('showReadingProgress').checked = settings.showReadingProgress;
                if (!settings.showReadingProgress) {
                    document.querySelector('.reading-progress').style.display = 'none';
                    document.getElementById('progressIndicator').style.display = 'none';
                }
            }
            
            if (settings.enableAnimations !== undefined) {
                document.getElementById('enableAnimations').checked = settings.enableAnimations;
                if (!settings.enableAnimations) {
                    document.body.style.setProperty('--animation-duration', '0s');
                }
            }
            
            if (settings.highContrast) {
                document.getElementById('highContrast').checked = settings.highContrast;
                if (settings.highContrast) {
                    document.body.classList.add('high-contrast');
                }
            }
        }
        
        // به‌روزرسانی دکمه‌های حالت نمایش
        function updateViewModeButtons(mode) {
            document.querySelectorAll('.view-mode-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('data-mode') === mode) {
                    btn.classList.add('active');
                }
            });
        }
        
        // بارگذاری لیست تمام فایل‌ها
        async function loadAllFileNames() {
            try {
                addLogEntry('در حال بارگذاری لیست فایل‌ها از گیت‌هاب...', 'info');
                
                const GITHUB_API_BASE = 'https://api.github.com/repos/linuxpersian/linuxpersian.github.io/contents/wiki/source';
                const response = await fetch(GITHUB_API_BASE);
                
                if (!response.ok) {
                    throw new Error(`خطای HTTP در بارگذاری لیست فایل‌ها! وضعیت: ${response.status}`);
                }
                
                const files = await response.json();
                allFileNames = files
                    .filter(file => file.name.endsWith('.md'))
                    .map(file => file.name)
                    .sort(); // مرتب‌سازی الفبایی برای ناوبری بعدی/قبلی
                
                addLogEntry(`تعداد ${allFileNames.length} فایل مارک‌دان یافت شد.`, 'success');
                console.log('All file names loaded:', allFileNames);
            } catch (error) {
                console.error('خطا در بارگذاری لیست فایل‌ها:', error);
                addLogEntry(`خطا در بارگذاری لیست فایل‌ها: ${error.message}`, 'error');
            }
        }
        
        // بارگذاری فایل
        async function loadFile() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                let fileName = urlParams.get('file');
                
                if (!fileName) {
                    showError('نام فایل مشخص نشده است.');
                    return;
                }
                
                // اطمینان از اینکه نام فایل دارای پسوند .md است
                if (!fileName.endsWith('.md')) {
                    fileName += '.md';
                }
                
                currentFile = fileName;
                addLogEntry(`در حال بارگذاری فایل: ${fileName}`, 'info');
                
                // استفاده از آدرس صحیح گیت‌هاب
                const GITHUB_RAW_BASE = 'https://raw.githubusercontent.com/linuxpersian/linuxpersian.github.io/main/wiki/source';
                const fileUrl = `${GITHUB_RAW_BASE}/${fileName}`;
                
                addLogEntry(`در حال ارسال درخواست به: ${fileUrl}`, 'info');
                
                const response = await fetch(fileUrl);
                
                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('فایل مورد نظر یافت نشد. ممکن است حذف شده یا نام آن تغییر کرده باشد.');
                    } else {
                        throw new Error(`خطا در بارگذاری فایل: ${response.status} - ${response.statusText}`);
                    }
                }
                
                const content = await response.text();
                currentContent = content;
                
                addLogEntry('فایل با موفقیت بارگذاری شد.', 'success');
                
                // استخراج عنوان
                const titleMatch = content.match(/^#\s+(.+)$/m);
                const title = titleMatch ? titleMatch[1].trim() : fileName.replace('.md', '');
                
                document.getElementById('articleTitle').textContent = title;
                document.title = `${title} - ویکی لینوکس فارسی`;
                
                // پردازش و نمایش محتوا
                displayContent(content);
                
                // استخراج و نمایش تگ‌ها
                const tags = tagSystem.extractTags(content);
                displayTags(tags);
                
                // به‌روزرسانی اطلاعات متا
                updateMetadata(content);
                
                // بازیابی موقعیت خواندن
                restoreReadingPosition();
                
                // غیرفعال کردن اعلان‌ها
                // showToast('مقاله با موفقیت بارگذاری شد.', 'success');
            } catch (error) {
                console.error('Error loading file:', error);
                addLogEntry(`خطا در بارگذاری فایل: ${error.message}`, 'error');
                showErrorWithRetry(`خطا در بارگذاری مقاله: ${error.message}`);
            }
        }
        
        // نمایش خطا با دکمه تلاش مجدد
        function showErrorWithRetry(message) {
            document.getElementById('markdownContent').innerHTML = `
                <div class="error-message p-8 bg-red-50 dark:bg-red-900/20 rounded-lg text-center">
                    <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                    <h2 class="text-xl font-bold text-red-700 dark:text-red-300 mb-2">خطا در بارگذاری مقاله</h2>
                    <p class="text-red-600 dark:text-red-400 mb-6">${message}</p>
                    <button class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition mr-2" onclick="window.history.back()">
                        بازگشت
                    </button>
                    <button class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition" onclick="retryLoading()">
                        تلاش مجدد
                    </button>
                </div>
            `;
        }
        
        // تلاش مجدد برای بارگذاری
        function retryLoading() {
            showLoading();
            loadFile();
        }
        
        // نمایش محتوا
        function displayContent(content) {
            try {
                // پیکربندی marked.js
                marked.setOptions({
                    breaks: true,
                    gfm: true,
                    headerIds: true,
                    headerPrefix: 'heading-'
                });
                
                // تبدیل مارک‌دان به HTML
                let html = marked.parse(content);
                
                // پردازش HTML برای RTL و استایل‌ها
                html = processHTML(html);
                
                // نمایش محتوا
                document.getElementById('markdownContent').innerHTML = html;
                
                // هایلایت کردن کد
                if (document.getElementById('highlightCode')?.checked) {
                    Prism.highlightAll();
                }
                
                // افزودن دکمه کپی به کدها
                addCopyButtons();
                
                // افزودن رویداد به تصاویر برای لایت‌باکس
                if (document.getElementById('loadImages')?.checked) {
                    setupImageLightbox();
                }
            } catch (error) {
                console.error('Error processing content:', error);
                showError('خطا در پردازش محتوای مقاله.');
            }
        }
        
        // پردازش HTML
        function processHTML(html) {
            // تنظیم جهت متن
            html = html.replace(/<p>/g, '<p dir="auto">');
            html = html.replace(/<h[1-6]>/g, '<h$1 dir="auto">');
            html = html.replace(/<li>/g, '<li dir="auto">');
            html = html.replace(/<blockquote>/g, '<blockquote dir="auto">');
            
            // استایل‌های تصاویر
            html = html.replace(/<img/g, '<img class="rounded-lg shadow-lg my-4 cursor-pointer"');
            
            // استایل‌های جداول
            html = html.replace(/<table>/g, '<table class="w-full border-collapse my-6">');
            html = html.replace(/<th>/g, '<th class="border px-4 py-2 bg-gray-100 dark:bg-gray-700">');
            html = html.replace(/<td>/g, '<td class="border px-4 py-2">');
            
            // استایل‌های کد
            html = html.replace(/<pre>/g, '<pre class="rounded-lg overflow-x-auto my-4">');
            html = html.replace(/<code>/g, '<code class="rounded">');
            
            return html;
        }
        
        // افزودن دکمه کپی به کدها
        function addCopyButtons() {
            document.querySelectorAll('pre').forEach(pre => {
                const button = document.createElement('button');
                button.className = 'copy-code-btn';
                button.textContent = 'کپی';
                button.onclick = () => copyCode(pre);
                pre.appendChild(button);
            });
        }
        
        // کپی کردن کد
        function copyCode(pre) {
            const code = pre.querySelector('code');
            const text = code.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                // غیرفعال کردن اعلان‌ها
                // showToast('کد با موفقیت کپی شد.', 'success');
            }).catch(err => {
                console.error('Error copying code:', err);
                // showToast('خطا در کپی کردن کد.', 'error');
            });
        }
        
        // تنظیم لایت‌باکس تصاویر
        function setupImageLightbox() {
            document.querySelectorAll('.markdown-content img').forEach(img => {
                img.addEventListener('click', () => {
                    document.getElementById('lightboxImage').src = img.src;
                    document.getElementById('lightbox').style.display = 'flex';
                });
            });
        }
        
        // بستن لایت‌باکس
        function closeLightbox() {
            document.getElementById('lightbox').style.display = 'none';
        }
        
        // تولید فهرست مطالب
        function generateTableOfContents() {
            const headings = document.querySelectorAll('.markdown-content h1, .markdown-content h2, .markdown-content h3');
            const toc = document.getElementById('tableOfContents');
            
            if (headings.length === 0) {
                toc.innerHTML = '<p class="text-gray-500">فهرست مطالبی یافت نشد.</p>';
                return;
            }
            
            toc.innerHTML = '';
            
            headings.forEach((heading, index) => {
                const level = parseInt(heading.tagName.substring(1));
                const text = heading.textContent;
                const id = heading.id || `heading-${index}`;
                
                heading.id = id;
                
                const item = document.createElement('div');
                item.className = 'toc-item';
                item.style.paddingRight = `${(level - 1) * 1}rem`;
                
                const link = document.createElement('a');
                link.href = `#${id}`;
                link.className = 'toc-link';
                link.textContent = text;
                link.onclick = (e) => {
                    e.preventDefault();
                    heading.scrollIntoView({ behavior: 'smooth' });
                    
                    // به‌روزرسانی لینک فعال
                    document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                };
                
                item.appendChild(link);
                toc.appendChild(item);
            });
        }
        
        // نمایش تگ‌ها
        function displayTags(tags) {
            const tagsContainer = document.getElementById('tagsCloud');
            
            if (tags.length === 0) {
                tagsContainer.innerHTML = '<p class="text-gray-500">تگی یافت نشد.</p>';
                return;
            }
            
            tagsContainer.innerHTML = '';
            
            tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'tag';
                tagElement.textContent = tag.name;
                tagElement.onclick = () => filterByTag(tag.id);
                tagsContainer.appendChild(tagElement);
            });
        }
        
        // فیلتر بر اساس تگ
        function filterByTag(tagId) {
            // غیرفعال کردن اعلان‌ها
            // showToast(`نمایش مقالات مرتبط با: ${tagSystem.getTagName(tagId)}`, 'info');
            // در اینجا می‌توان منطق فیلتر کردن را پیاده‌سازی کرد
        }
        
        // به‌روزرسانی اطلاعات متا
        function updateMetadata(content) {
            // محاسبه زمان خواندن
            const wordsPerMinute = 200;
            const wordCount = content.split(/\s+/).length;
            const readingTime = Math.ceil(wordCount / wordsPerMinute);
            
            // به‌روزرسانی نمایش
            document.getElementById('metaDate').textContent = new Date().toLocaleDateString('fa-IR');
            document.getElementById('metaReadingTime').textContent = `${readingTime} دقیقه`;
            document.getElementById('metaWordCount').textContent = `${wordCount.toLocaleString('fa-IR')} کلمه`;
            document.getElementById('metaViews').textContent = '1,234 بازدید';
            document.getElementById('metaRating').textContent = '4.7/5';
        }
        
        // بازیابی موقعیت خواندن
        function restoreReadingPosition() {
            const position = localStorage.getItem(`readingPosition_${currentFile}`);
            if (position) {
                window.scrollTo(0, parseInt(position));
            }
        }
        
        // ذخیره موقعیت خواندن
        function saveReadingPosition() {
            if (currentFile) {
                localStorage.setItem(`readingPosition_${currentFile}`, window.scrollY);
            }
        }
        
        // جستجو در مقاله
        function searchInArticle() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (!query) {
                clearSearchHighlights();
                return;
            }
            
            // پاک کردن هایلایت‌های قبلی
            clearSearchHighlights();
            
            // جستجو و هایلایت
            const content = document.getElementById('markdownContent');
            const walker = document.createTreeWalker(
                content,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );
            
            const regex = new RegExp(`(${query})`, 'gi');
            searchHighlights = [];
            
            while (walker.nextNode()) {
                const node = walker.currentNode;
                const text = node.textContent;
                
                if (text.toLowerCase().includes(query)) {
                    const span = document.createElement('span');
                    span.innerHTML = text.replace(regex, '<span class="search-highlight">$1</span>');
                    node.parentNode.replaceChild(span, node);
                    
                    // ذخیره موقعیت‌های هایلایت
                    const highlights = span.querySelectorAll('.search-highlight');
                    highlights.forEach(highlight => {
                        searchHighlights.push(highlight);
                    });
                }
            }
            
            // اسکرول به اولین نتیجه
            if (searchHighlights.length > 0) {
                currentSearchIndex = 0;
                searchHighlights[currentSearchIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
                // غیرفعال کردن اعلان‌ها
                // showToast(`${searchHighlights.length} نتیجه یافت شد.`, 'success');
            } else {
                // showToast('هیچ نتیجه‌ای یافت نشد.', 'error');
            }
        }
        
        // پاک کردن هایلایت‌های جستجو
        function clearSearchHighlights() {
            const highlights = document.querySelectorAll('.search-highlight');
            highlights.forEach(highlight => {
                const parent = highlight.parentNode;
                parent.replaceChild(document.createTextNode(highlight.textContent), highlight);
                parent.normalize();
            });
            searchHighlights = [];
        }
        
        // تنظیم رویدادها
        function setupEventListeners() {
            // رویداد اسکرول برای ذخیره موقعیت خواندن و نوار پیشرفت
            window.addEventListener('scroll', () => {
                if (document.getElementById('autoSave')?.checked) {
                    saveReadingPosition();
                }
                updateReadingProgress();
                updateProgressIndicator();
            });
            
            // رویداد کلید برای جستجو
            document.getElementById('searchInput').addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    searchInArticle();
                }
                if (e.key === 'Escape') {
                    clearSearchHighlights();
                    document.getElementById('searchInput').value = '';
                }
            });
            
            // رویداد تغییر اندازه فونت
            document.getElementById('justifyText')?.addEventListener('change', (e) => {
                const content = document.getElementById('markdownContent');
                if (e.target.checked) {
                    content.style.textAlign = 'justify';
                } else {
                    content.style.textAlign = 'right';
                }
            });
            
            // رویداد تغییر شماره خطوط کد
            document.getElementById('lineNumbers')?.addEventListener('change', (e) => {
                const codes = document.querySelectorAll('pre code');
                codes.forEach(code => {
                    if (e.target.checked) {
                        // افزودن شماره خطوط
                        const lines = code.textContent.split('\n');
                        const numberedLines = lines.map((line, i) => {
                            return `<span class="line-number">${i + 1}</span>${line}`;
                        }).join('\n');
                        code.innerHTML = numberedLines;
                    } else {
                        // حذف شماره خطوط
                        const lines = code.innerHTML.split('\n');
                        const cleanLines = lines.map(line => {
                            return line.replace(/<span class="line-number">\d+<\/span>/, '');
                        }).join('\n');
                        code.innerHTML = cleanLines;
                    }
                });
            });
            
            // رویدادهای کیبورد
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + K برای جستجو
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                
                // Ctrl/Cmd + D برای حالت تاریک
                if ((e.ctrlKey || e.metaKey) && e.key === 'd') {
                    e.preventDefault();
                    toggleDarkMode();
                }
                
                // Ctrl/Cmd + P برای چاپ
                if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                    e.preventDefault();
                    window.print();
                }
                
                // Ctrl/Cmd + S برای ذخیره
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    downloadMarkdown();
                }
                
                // F3 برای جستجوی بعدی
                if (e.key === 'F3' && searchHighlights.length > 0) {
                    e.preventDefault();
                    navigateSearchResults(1);
                }
                
                // Shift + F3 برای جستجوی قبلی
                if (e.key === 'F3' && e.shiftKey && searchHighlights.length > 0) {
                    e.preventDefault();
                    navigateSearchResults(-1);
                }
            });
            
            // رویداد تغییر اندازه صفحه
            window.addEventListener('resize', () => {
                if (window.innerWidth > 768 && sidebarOpen) {
                    toggleSidebar();
                }
            });
        }
        
        // ناوبری نتایج جستجو
        function navigateSearchResults(direction) {
            if (searchHighlights.length === 0) return;
            
            currentSearchIndex += direction;
            
            if (currentSearchIndex >= searchHighlights.length) {
                currentSearchIndex = 0;
            } else if (currentSearchIndex < 0) {
                currentSearchIndex = searchHighlights.length - 1;
            }
            
            searchHighlights[currentSearchIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        // تغییر حالت نمایش
        function setViewMode(mode, buttonElement = null) {
            currentViewMode = mode;
            localStorage.setItem('viewMode', mode);
            
            // حذف تمام کلاس‌های حالت
            document.body.classList.remove('reading-mode');
            
            // افزودن کلاس حالت جدید
            if (mode === 'reading') {
                document.body.classList.add('reading-mode');
                document.getElementById('quickReadingMode').checked = true;
            } else {
                document.getElementById('quickReadingMode').checked = false;
            }
            
            // به‌روزرسانی دکمه‌های فعال
            if (buttonElement) {
                document.querySelectorAll('.view-mode-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                buttonElement.classList.add('active');
            } else {
                updateViewModeButtons(mode);
            }
        }
        
        // تغییر حالت تاریک
        function toggleDarkMode() {
            isDarkMode = !isDarkMode;
            localStorage.setItem('isDarkMode', isDarkMode);
            
            if (isDarkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('quickDarkMode').checked = true;
            } else {
                document.body.classList.remove('dark-mode');
                document.getElementById('quickDarkMode').checked = false;
            }
        }
        
        // تغییر اندازه فونت
        function setFontSize(size) {
            fontSize = size;
            localStorage.setItem('fontSize', size);
            document.getElementById('markdownContent').style.fontSize = `${size}px`;
            document.getElementById('fontSizeValue').textContent = size;
            document.getElementById('fontSizeSlider').value = size;
        }
        
        function setFontSizeFromSlider(size) {
            setFontSize(size);
        }
        
        function increaseFontSize() {
            if (fontSize < 24) {
                setFontSize(fontSize + 2);
            }
        }
        
        function decreaseFontSize() {
            if (fontSize > 12) {
                setFontSize(fontSize - 2);
            }
        }
        
        // تنظیم اندازه متن
        function setTextSize(size) {
            document.getElementById('markdownContent').style.fontSize = `${size}%`;
            document.getElementById('textSizeValue').textContent = size;
        }
        
        // تنظیم فاصله خطوط
        function setLineHeight(height) {
            document.getElementById('markdownContent').style.lineHeight = height;
            document.getElementById('lineHeightValue').textContent = height;
        }
        
        // اشتراک‌گذاری مقاله
        function shareArticle() {
            if (navigator.share) {
                navigator.share({
                    title: document.getElementById('articleTitle').textContent,
                    text: 'مقاله جالبی از ویکی لینوکس فارسی',
                    url: window.location.href
                })
                .then(() => {
                    // غیرفعال کردن اعلان‌ها
                    // showToast('مقاله با موفقیت به اشتراک گذاشته شد.', 'success');
                })
                .catch((error) => console.log('Error sharing:', error));
            } else {
                // کپی کردن لینک به کلیپ‌بورد
                navigator.clipboard.writeText(window.location.href)
                    .then(() => {
                        // غیرفعال کردن اعلان‌ها
                        // showToast('لینک مقاله کپی شد.', 'success');
                    })
                    .catch(() => {
                        // showToast('خطا در کپی لینک.', 'error');
                    });
            }
        }
        
        // دانلود مارک‌دان
        function downloadMarkdown() {
            if (!currentContent) {
                // showToast('محتوایی برای دانلود وجود ندارد.', 'error');
                return;
            }
            
            const blob = new Blob([currentContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = currentFile;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // غیرفعال کردن اعلان‌ها
            // showToast('فایل با موفقیت دانلود شد.', 'success');
        }
        
        // اسکرول به بالا
        function scrollToTop() {
            if (document.getElementById('smoothScroll')?.checked) {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            } else {
                window.scrollTo(0, 0);
            }
        }
        
        // باز کردن مودال
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }
        
        // بستن مودال
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // تنظیم تم رنگی
        function setTheme(theme) {
            // حذف کلاس‌های تم قبلی
            document.body.classList.remove('theme-blue', 'theme-green', 'theme-red', 'theme-orange', 
                                   'theme-purple', 'theme-teal', 'theme-amber', 'theme-pink', 'theme-indigo');
            
            // افزودن کلاس تم جدید
            if (theme !== 'default') {
                document.body.classList.add(`theme-${theme}`);
            }
            
            // حذف کلاس فعال از تمام گزینه‌ها
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            
            // افزودن کلاس فعال به گزینه انتخاب شده
            const selectedOption = document.querySelector(`.theme-${theme}`);
            if (selectedOption) {
                selectedOption.classList.add('active');
            }
            
            // ذخیره تنظیمات
            const settings = JSON.parse(localStorage.getItem('settings') || '{}');
            settings.theme = theme;
            localStorage.setItem('settings', JSON.stringify(settings));
            
            // غیرفعال کردن اعلان‌ها
            // showToast(`تم ${theme} اعمال شد.`, 'success');
        }
        
        // ذخیره تنظیمات
        function saveSettings() {
            const settings = {
                isDarkMode: isDarkMode,
                fontSize: fontSize,
                viewMode: currentViewMode,
                theme: document.querySelector('.theme-option.active')?.className.split(' ')[1] || 'default',
                textSize: document.getElementById('textSizeSlider').value,
                lineHeight: document.getElementById('lineHeightSlider').value,
                justifyText: document.getElementById('justifyText').checked,
                lineNumbers: document.getElementById('lineNumbers').checked,
                loadImages: document.getElementById('loadImages').checked,
                autoSave: document.getElementById('autoSave').checked,
                smoothScroll: document.getElementById('smoothScroll').checked,
                highlightCode: document.getElementById('highlightCode').checked,
                showReadingProgress: document.getElementById('showReadingProgress').checked,
                enableAnimations: document.getElementById('enableAnimations').checked,
                highContrast: document.getElementById('highContrast').checked
            };
            
            localStorage.setItem('settings', JSON.stringify(settings));
            closeModal('settingsModal');
            // غیرفعال کردن اعلان‌ها
            // showToast('تنظیمات با موفقیت ذخیره شد.', 'success');
        }
        
        // خروجی تنظیمات
        function exportSettings() {
            const settings = JSON.parse(localStorage.getItem('settings') || '{}');
            const blob = new Blob([JSON.stringify(settings, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'viewer-settings.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // غیرفعال کردن اعلان‌ها
            // showToast('تنظیمات با موفقیت خروجی گرفته شد.', 'success');
        }
        
        // ورود تنظیمات
        function importSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const settings = JSON.parse(event.target.result);
                        localStorage.setItem('settings', JSON.stringify(settings));
                        // showToast('تنظیمات با موفقیت وارد شد. صفحه برای اعمال تغییرات بازخوانی می‌شود.', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                    } catch (error) {
                        // showToast('خطا در خواندن فایل تنظیمات.', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // بازنشانی تنظیمات
        function resetSettings() {
            if (confirm('آیا از بازنشانی تنظیمات مطمئن هستید؟')) {
                localStorage.removeItem('settings');
                localStorage.removeItem('isDarkMode');
                localStorage.removeItem('fontSize');
                localStorage.removeItem('viewMode');
                // showToast('تنظیمات با موفقیت بازنشانی شد. صفحه برای اعمال تغییرات بازخوانی می‌شود.', 'success');
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
            }
        }
        
        // نمایش اعلان - غیرفعال شده
        function showToast(message, type = 'info') {
            // تابع خالی برای غیرفعال کردن اعلان‌ها
        }
        
        // نمایش خطا
        function showError(message) {
            showToast(message, 'error');
            document.getElementById('markdownContent').innerHTML = `
                <div class="error-message p-8 bg-red-50 dark:bg-red-900/20 rounded-lg text-center">
                    <i class="fas fa-exclamation-triangle text-red-500 text-4xl mb-4"></i>
                    <h2 class="text-xl font-bold text-red-700 dark:text-red-300 mb-2">خطا در بارگذاری مقاله</h2>
                    <p class="text-red-600 dark:text-red-400">${message}</p>
                    <button class="mt-4 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition" onclick="window.history.back()">
                        بازگشت
                    </button>
                </div>
            `;
        }
        
        // به‌روزرسانی تعداد بازدید
        function updateViewCount() {
            // در یک پیاده‌سازی واقعی، این اطلاعات از سرور دریافت می‌شود
            // اینجا فقط یک نمایش شبیه‌سازی شده است
            const viewsElement = document.getElementById('metaViews');
            if (viewsElement) {
                const currentViews = parseInt(viewsElement.textContent.replace(/[^\d]/g, ''));
                const newViews = currentViews + 1;
                viewsElement.textContent = `${newViews.toLocaleString('fa-IR')} بازدید`;
            }
        }
        
        // تنظیم نوار پیشرفت خواندن
        function setupReadingProgress() {
            window.addEventListener('scroll', updateReadingProgress);
        }
        
        // به‌روزرسانی نوار پیشرفت خواندن
        function updateReadingProgress() {
            if (!document.getElementById('showReadingProgress')?.checked) {
                return;
            }
            
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            
            document.getElementById('readingProgressBar').style.width = `${scrollPercent}%`;
        }
        
        // تنظیم نشانگر پیشرفت
        function setupProgressIndicator() {
            if (!document.getElementById('showReadingProgress')?.checked) {
                document.getElementById('progressIndicator').style.display = 'none';
            }
        }
        
        // به‌روزرسانی نشانگر پیشرفت
        function updateProgressIndicator() {
            if (!document.getElementById('showReadingProgress')?.checked) {
                return;
            }
            
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = Math.round((scrollTop / docHeight) * 100);
            
            document.getElementById('progressFill').style.width = `${scrollPercent}%`;
            document.getElementById('progressText').textContent = `${scrollPercent}%`;
        }
        
        // تنظیم انتخاب متن
        function setupTextSelection() {
            document.addEventListener('mouseup', () => {
                const selectedText = window.getSelection().toString().trim();
                if (selectedText) {
                    this.selectedText = selectedText;
                    showTextSelectionMenu();
                } else {
                    hideTextSelectionMenu();
                }
            });
            
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.text-selection-menu')) {
                    hideTextSelectionMenu();
                }
            });
        }
        
        // نمایش منوی انتخاب متن
        function showTextSelectionMenu() {
            const menu = document.getElementById('textSelectionMenu');
            const selection = window.getSelection();
            
            if (selection.rangeCount > 0 && !selection.isCollapsed) {
                const range = selection.getRangeAt(0);
                const rect = range.getBoundingClientRect();
                
                menu.style.display = 'flex';
                menu.style.top = `${rect.top - 60}px`;
                menu.style.left = `${rect.left + (rect.width / 2) - (menu.offsetWidth / 2)}px`;
            }
        }
        
        // پنهان کردن منوی انتخاب متن
        function hideTextSelectionMenu() {
            document.getElementById('textSelectionMenu').style.display = 'none';
        }
        
        // کپی متن انتخاب شده
        function copySelectedText() {
            const selectedText = window.getSelection().toString();
            navigator.clipboard.writeText(selectedText).then(() => {
                // showToast('متن با موفقیت کپی شد.', 'success');
                hideTextSelectionMenu();
            }).catch(err => {
                // showToast('خطا در کپی کردن متن.', 'error');
            });
        }
        
        // جستجوی متن انتخاب شده
        function searchSelectedText() {
            const selectedText = window.getSelection().toString();
            document.getElementById('searchInput').value = selectedText;
            searchInArticle();
            hideTextSelectionMenu();
        }
        
        // هایلایت کردن متن انتخاب شده
        function highlightSelectedText() {
            const selection = window.getSelection();
            if (selection.rangeCount > 0) {
                const range = selection.getRangeAt(0);
                const span = document.createElement('span');
                span.style.backgroundColor = 'rgba(255, 255, 0, 0.4)';
                span.style.padding = '0 2px';
                span.style.borderRadius = '2px';
                
                try {
                    range.surroundContents(span);
                    // showToast('متن با موفقیت هایلایت شد.', 'success');
                } catch (e) {
                    // showToast('خطا در هایلایت کردن متن.', 'error');
                }
                
                hideTextSelectionMenu();
            }
        }
        
        // خواندن متن انتخاب شده
        function speakSelectedText() {
            const selectedText = window.getSelection().toString();
            
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(selectedText);
                utterance.lang = 'fa-IR';
                utterance.rate = 0.9;
                
                speechSynthesis.speak(utterance);
                // showToast('در حال خواندن متن...', 'info');
                
                utterance.onend = () => {
                    // showToast('پایان خواندن متن.', 'info');
                };
            } else {
                // showToast('مرورگر شما از متن به گفتار پشتیبانی نمی‌کند.', 'error');
            }
            
            hideTextSelectionMenu();
        }
        
        // توابع جدید برای قابلیت‌های اضافه شده
        
        // تغییر وضعیت سایدبار برای موبایل
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebarOpen = !sidebarOpen;
            
            if (sidebarOpen) {
                sidebar.classList.add('open');
                overlay.classList.add('active');
            } else {
                sidebar.classList.remove('open');
                overlay.classList.remove('active');
            }
        }
        
        // تغییر وضعیت منوی سریع
        function toggleQuickMenu() {
            const quickMenu = document.getElementById('quickMenu');
            
            quickMenuOpen = !quickMenuOpen;
            
            if (quickMenuOpen) {
                quickMenu.classList.add('active');
                // بستن تنظیمات سریع اگر باز باشد
                if (quickSettingsOpen) {
                    toggleQuickSettings();
                }
            } else {
                quickMenu.classList.remove('active');
            }
        }
        
        // تغییر وضعیت تنظیمات سریع
        function toggleQuickSettings() {
            const quickSettings = document.getElementById('quickSettings');
            
            quickSettingsOpen = !quickSettingsOpen;
            
            if (quickSettingsOpen) {
                quickSettings.classList.add('active');
                // بستن منوی سریع اگر باز باشد
                if (quickMenuOpen) {
                    toggleQuickMenu();
                }
            } else {
                quickSettings.classList.remove('active');
            }
        }
        
        // تغییر وضعیت حالت خواندن از تنظیمات سریع
        function toggleReadingMode() {
            if (currentViewMode === 'reading') {
                setViewMode('normal');
            } else {
                setViewMode('reading');
            }
        }
        
        // تغییر وضعیت هایلایت کد از تنظیمات سریع
        function toggleCodeHighlighting() {
            const highlightCode = document.getElementById('quickHighlightCode').checked;
            document.getElementById('highlightCode').checked = highlightCode;
            
            if (highlightCode) {
                Prism.highlightAll();
            }
        }
        
        // تغییر وضعیت بارگذاری تصاویر از تنظیمات سریع
        function toggleImageLoading() {
            const loadImages = document.getElementById('quickLoadImages').checked;
            document.getElementById('loadImages').checked = loadImages;
            
            if (loadImages) {
                setupImageLightbox();
            }
        }
        
        // خروجی PDF
        function exportToPDF() {
            // در یک پیاده‌سازی واقعی، این کار با استفاده از کتابخانه‌هایی مانند jsPDF انجام می‌شود
            // showToast('در حال آماده‌سازی خروجی PDF...', 'info');
            
            // شبیه‌سازی فرآیند خروجی گرفتن
            setTimeout(() => {
                // showToast('خروجی PDF با موفقیت آماده شد.', 'success');
            }, 2000);
        }
        
        // تغییر وضعیت تمام صفحه
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    // showToast(`خطا در فعال‌سازی حالت تمام صفحه: ${err.message}`, 'error');
                });
            } else {
                document.exitFullscreen();
            }
        }
        
        // ذخیره نشانک
        function saveBookmark() {
            const position = window.scrollY;
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '{}');
            
            if (!bookmarks[currentFile]) {
                bookmarks[currentFile] = [];
            }
            
            bookmarks[currentFile].push({
                position: position,
                title: `نشانک ${bookmarks[currentFile].length + 1}`,
                timestamp: new Date().toISOString()
            });
            
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
            // showToast('نشانک با موفقیت ذخیره شد.', 'success');
        }
        
        // باز کردن مودال یادداشت‌ها
        function openNotesModal() {
            // در یک پیاده‌سازی واقعی، این مودال برای مدیریت یادداشت‌ها استفاده می‌شود
            // showToast('در حال باز کردن یادداشت‌ها...', 'info');
        }
        
        // اجرای تابع مقداردهی اولیه پس از بارگذاری صفحه
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
