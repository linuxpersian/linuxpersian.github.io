# ساختار فایل‌های اجرایی باینری و امکان بازگردانی آن‌ها به سورس‌کد

در این نوشته تخصصی به بررسی ساختار فایل‌های اجرایی (Executable Binaries)، انواع آن‌ها، نحوه بازگردانی آن‌ها به سورس‌کد، و ارزیابی درصد موفقیت در دکامپایل (Decompilation) می‌پردازیم.

---

## 🔧 آیا فایل‌های اجرایی دارای ساختار خاصی هستند؟

بله، فایل‌های اجرایی (مثل `.exe` در ویندوز یا فایل‌های `.elf` در لینوکس) **دارای ساختاری دقیق و از پیش‌تعریف‌شده** هستند که توسط سیستم‌عامل‌ها و ماشین‌ها برای تفسیر و اجرای دستورات استفاده می‌شود. این فایل‌ها برخلاف فایل‌های متنی یا آرشیوی (مانند `.zip`) به صورت باینری و کد ماشین ذخیره شده‌اند و **مستقیماً قابل درک برای انسان نیستند**.

### 📁 مقایسه با فایل‌های ZIP:

* **فایل‌های ZIP** فشرده‌سازی شده و شامل ساختار مشخصی از فایل‌های درونی هستند؛ می‌توان آن‌ها را با ابزارهایی مثل WinRAR یا 7-Zip باز کرد.
* **فایل‌های اجرایی باینری** معمولاً **شامل سکشن‌هایی** هستند مانند:

  * `.text` (کد اجرایی برنامه)
  * `.data` (داده‌های مقداردهی‌شده)
  * `.bss` (داده‌های مقداردهی‌نشده)
  * `.rodata` (داده‌های فقط خواندنی)
  * `.symtab` و `.debug` (در حالت کامپایل با اطلاعات دیباگ)

> نتیجه: فایل‌های اجرایی **ساختار پیچیده‌ای دارند** اما قابل باز کردن مانند فایل ZIP نیستند؛ آن‌ها باید با ابزارهای تخصصی مانند Hex Editor یا disassembler تحلیل شوند.

---

## 📂 انواع فایل‌های اجرایی باینری

بر اساس سیستم‌عامل و معماری پردازنده، انواع فایل‌های اجرایی شامل موارد زیر می‌شوند:

| نوع فایل                             | سیستم‌عامل                  | معماری           | پسوند                |
| ------------------------------------ | --------------------------- | ---------------- | -------------------- |
| PE (Portable Executable)             | ویندوز                      | x86 / x64        | `.exe`, `.dll`       |
| ELF (Executable and Linkable Format) | لینوکس / یونیکس             | x86, ARM, RISC-V | بدون پسوند یا دلخواه |
| Mach-O (Mach Object)                 | macOS / iOS                 | x86\_64, ARM64   | `.app`, `.dylib`     |
| WASM (WebAssembly Binary)            | مرورگرها / اجرای ایزوله‌شده | مجازی            | `.wasm`              |

---

## 🔄 آیا می‌توان فایل‌های اجرایی را به سورس‌کد اولیه بازگرداند؟

### ✔️ پاسخ کوتاه: **تا حدودی بله، اما نه دقیقاً به سورس‌کد اصلی.**

وقتی کدی کامپایل می‌شود، اطلاعات مهمی مانند نام متغیرها، ساختار تابع‌ها، کامنت‌ها، و حتی گاهی نوع داده‌ها **از بین می‌روند** یا **مبهم می‌شوند**. با این حال، می‌توان با ابزارهایی به شکل تقریبی آن را به زبانی سطح بالا (مانند C یا شبه‌کد) بازگرداند.

---

## 🛠 ابزارهای بازگردانی (Decompilation Tools)

### 1. **Disassemblerها** – تبدیل باینری به اسمبلی

* **IDA Pro**
* **Ghidra** (ابزار رایگان و قدرتمند از NSA)
* **Radare2**
* **objdump** (برای فایل‌های ELF)

### 2. **Decompilerها** – تبدیل باینری به زبان سطح بالا

* **Hex-Rays** (مکمل IDA Pro – خروجی C مانند)
* **RetDec**
* **Ghidra Decompiler**
* **Snowman**

---

## 📉 درصد موفقیت در بازگردانی سورس‌کد

| سطح بازگردانی                                   | توضیح                                | درصد تخمینی موفقیت |
| ----------------------------------------------- | ------------------------------------ | ------------------ |
| سطح اسمبلی                                      | بسیار دقیق – ساختار CPU-level        | 95-100٪            |
| شبه‌کد C (بدون متغیرهای اصلی)                   | قابل فهم ولی نه دقیق                 | 60-80٪             |
| بازسازی دقیق سورس اصلی (با نام متغیرها و توابع) | تقریباً غیرممکن بدون debug symbols   | 5-15٪              |
| با وجود symbol table و debug info               | امکان بازیابی بخش بزرگی از سورس اصلی | 70-90٪             |

> 💡 **نکته:** اگر فایل اجرایی به صورت Debug یا با گزینه `-g` کامپایل شده باشد، اطلاعات نمادها (symbol information) موجود است و فرآیند بسیار ساده‌تر و دقیق‌تر می‌شود.

---

## ⚠️ چرا بازگردانی کامل ممکن نیست؟

* **بهینه‌سازی کامپایلر** (مثل inlining و loop unrolling) باعث تغییر کامل ساختار اولیه می‌شود.
* **حذف اطلاعات نماد** (Strip کردن) در فایل‌های اجرایی باعث غیرقابل بازگشت شدن بسیاری از اطلاعات می‌شود.
* **استفاده از obfuscation** یا ابزارهای فشرده‌سازی باینری (مثل UPX) بازگردانی را سخت‌تر می‌کند.

---

## ✅ جمع‌بندی

فایل‌های اجرایی ساختاری پیچیده و از پیش‌تعریف‌شده دارند که توسط سیستم‌عامل‌ها و پردازنده‌ها تفسیر می‌شوند. آن‌ها **قابل باز کردن مانند فایل‌های ZIP نیستند** ولی با ابزارهای تخصصی می‌توان محتویات آن‌ها را تحلیل و به شکلی از سورس‌کد بازگرداند. با این حال، **بازگردانی دقیق سورس اصلی بسیار دشوار یا غیرممکن** است، مگر اینکه فایل اجرایی با اطلاعات دیباگ ساخته شده باشد.

---
