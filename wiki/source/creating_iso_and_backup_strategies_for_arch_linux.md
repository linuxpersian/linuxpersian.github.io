# 🧩 ساخت فایل ISO از آرچ لینوکس و روش‌های پشتیبان‌گیری کامل از سیستم عامل

---

## ✅ بخش اول: چرا و چطور فایل ISO از سیستم عامل آرچ بگیریم؟

### 📌 هدف:

* ایجاد یک نسخه قابل نصب از **سیستم شخصی شما**
* بازیابی سریع سیستم در صورت خرابی یا تغییرات ناخواسته
* کلون گرفتن از سیستم برای نصب روی چندین دستگاه

---

## 🧰 روش ساخت فایل ISO قابل بوت از سیستم فعلی آرچ

### 🧱 ابزارهای اصلی:

1. **Archiso** – ابزار رسمی برای ساخت ISO در آرچ
2. **mkarchiso** – اسکریپت اصلی در بسته‌ی `archiso`
3. **releng profile** – نمایه رسمی که ISOهای اصلی آرچ را می‌سازد

### 💡 مراحل تخصصی:

#### مرحله 1: نصب بسته‌های لازم

```bash
sudo pacman -S archiso git
```

#### مرحله 2: کپی کردن پروفایل نمونه

```bash
cp -r /usr/share/archiso/configs/releng ~/archiso-custom
cd ~/archiso-custom
```

#### مرحله 3: شخصی‌سازی

* اضافه کردن فایل‌های دلخواه به `airootfs`

  * برای مثال `/etc/`, `/home/`, `custom packages`, `dotfiles`, `scripts`
* ویرایش فایل `packages.x86_64` برای تعیین پکیج‌ها
* ویرایش `airootfs/etc/skel` برای افزودن فایل‌های کاربر

#### مرحله 4: ساخت ISO

```bash
sudo mkarchiso -v .   # این دستور در همان دایرکتوری اجرا می‌شود
```

✅ خروجی: فایلی با پسوند `.iso` که یک لایو‌سیستم کامل از آرچ لینوکس شخصی‌شده شماست.

---

## 🛠️ روش نصب ISO ساخته‌شده (Boot + Install)

1. بوت از فایل ISO (در BIOS/UEFI)
2. ورود به محیط Live
3. استفاده از اسکریپت‌های موجود یا اجرای مراحل نصب دستی:

   * mount کردن پارتیشن‌ها
   * `rsync` برای کپی کردن root
   * نصب bootloader مثل `grub`
   * پیکربندی مجدد `/etc/fstab` و `/etc/hostname`

> این کار مثل نصب یک کلون از سیستم شماست، نه نصب آرچ خام.

---

## 📦 فایل ISO شامل چه مواردی می‌تواند باشد؟

بسته به پیکربندی شما:

| بخش            | شامل                                                 |
| -------------- | ---------------------------------------------------- |
| کرنل           | نسخه‌ای که نصب کرده‌اید (linux، linux-lts، zen و...) |
| پکیج‌ها        | تمام بسته‌های موجود در `packages.x86_64`             |
| فایل‌های سیستم | `/etc`, `/home`, `/usr/local`, `/var` و ...          |
| پیکربندی بوت   | grub/syslinux/systemd-boot بسته به انتخاب            |
| محیط دسکتاپ    | KDE, GNOME, i3 و... اگر در profile گنجانده شوند      |
| کاربران        | اگر در `airootfs` یا اسکریپت‌ها تعریف شوند           |

---

## 🧯 بخش دوم: روش‌های پشتیبان‌گیری (Backup) از آرچ لینوکس

### 🛡️ روش ۱: Rsync - ساده و قدرتمند

```bash
sudo rsync -aAXv --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} / /mnt/backup
```

* می‌توانید از آن برای بازیابی کامل سیستم استفاده کنید.
* سریع، سبک، و قابل اسکریپت‌نویسی.

---

### 🧪 روش ۲: Clonezilla - تصویربرداری از دیسک

* به صورت LiveCD بوت می‌شود.
* تصویر کامل از دیسک یا پارتیشن ایجاد می‌کند.
* فرمت اختصاصی فشرده دارد.

---

### 🔄 روش ۳: Btrfs Snapshot (در صورت استفاده از Btrfs)

* گرفتن snapshot از سیستم با `btrfs subvolume snapshot`
* ترکیب با ابزارهایی مثل `Timeshift` یا `Snapper`
* بازیابی به وضعیت قبلی در چند ثانیه

---

### 💽 روش ۴: ابزارهایی مانند `Timeshift`

* رابط گرافیکی برای گرفتن snapshot دوره‌ای از سیستم
* پشتیبانی از `rsync` یا `btrfs`
* مناسب برای کاربران دسکتاپ

---

### ☁️ روش ۵: پشتیبان‌گیری ابری

* استفاده از `rclone`, `borg`, `restic` برای ارسال فایل‌ها به:

  * Google Drive
  * Dropbox
  * S3, Backblaze
* رمزنگاری و فشرده‌سازی فایل‌ها

---

## 🎯 نتیجه‌گیری و پیشنهاد

| هدف                                      | روش پیشنهادی                               |
| ---------------------------------------- | ------------------------------------------ |
| ساخت ISO قابل نصب از سیستم               | `archiso + mkarchiso`                      |
| بکاپ منظم سیستم خانگی                    | `Timeshift` یا `rsync`                     |
| پشتیبان‌گیری حرفه‌ای و قابل بازیابی کامل | `Clonezilla` یا `btrfs snapshots`          |
| انتقال سیستم به دستگاه دیگر              | ساخت ISO و نصب مجدد یا `rsync` full backup |

---

